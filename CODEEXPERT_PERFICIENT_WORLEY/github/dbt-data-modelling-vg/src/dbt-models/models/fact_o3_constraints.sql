{{ config(materialized='table') }}

select 
    cast(primary_key as varchar) as constraintpk,
    cast(id as int),
    cast(entityid as int),
    cast(entitytypeid as int),
    cast(projectid as int),
    cast(projectinfo as varchar),
    cast(constrainttypeid as int),
    cast(constraintid as varchar),
    cast(actionentitytypeid as int),
    cast(entitycontractid as int),
    cast(entityname as varchar),
    cast(statusid as int),
    cast(status as varchar),
    cast(statuscolor as varchar),
    cast(priorityid as int),
    cast(priority as varchar),
    cast(hardconstraint as boolean),
    cast(companyid as varchar),
    cast(company as varchar),
    cast(category as varchar),
    cast("constraint" as varchar),
    cast(longname as varchar) as constraintlongdescription,
    cast(description as varchar) as constraintdescription,
    cast(entityplannedstartdate as varchar),
    cast(countdown as int),
    cast(editorroleids as varchar),
    cast(sortorder as int),
    cast(workpackagestageid as int),
    cast(workpackagestage as varchar),
    cast(workpackagestagesortorder as int),
    cast(notes as varchar),
    cast(constructionworkareaid as int),
    cast(disciplineid as int),
    cast(discipline as varchar),
    cast(disciplinedescription as varchar),
    cast(purposeid as int),
    cast(purpose as varchar),
    cast(zoneid as int),
    cast(zone as varchar),
    cast(constructiontypeid as int),
    cast(constructiontype as varchar),
    cast(areaid as int),
    cast(area as varchar),
    cast(contractid as int),
    cast(contract as varchar),
    cast(planneruserid as int),
    cast(planneruser as varchar),
    cast(scheduleactivityid as varchar),
    cast(unitid as int),
    cast(unit as varchar),
    cast(ewpestimatedhours as varchar),
    cast(constructionworkpackageid as int),
    cast(cwp as varchar) as cwpsid,
    cast(assignedtoroleid as varchar),
    cast(assignedtorole as varchar),
    cast(assignedtousergroupid as varchar),
    cast(assignedtousergroup as varchar),
    cast(assignedtouserid as int),
    cast(assignedtouser as varchar),
    cast(assignedbyuserid as int),
    cast(assignedbyuser as varchar),
    cast(dateassigned as varchar),
    cast(completedbyuserid as int),
    cast(completedbyuser as varchar),
    cast(datecompleted as timestamp),
    cast(iscomplete as boolean),
    cast(datedue as timestamp),
    cast(forecastdate as timestamp),
    cast(commentcount as int),
    cast(sourceid as varchar),
    cast(source as varchar),
    cast(sourcekey as varchar),
    cast(sourceimportid as varchar),
    cast(datemarkedneedsverification as timestamp),
    cast(markedneedsverificationuserid as varchar),
    cast(markedneedsverificationbyuser as varchar),
    cast(datecreated as timestamp),
    cast(createdbyuserid as int),
    cast(createdbyuser as varchar),
    cast(datemodified as timestamp),
    cast(modifiedbyuserid as int),
    cast(modifiedbyuser as varchar),
    cast(dateduedateassigned as timestamp),
    cast(daystoduedate as int),
    cast(urgencyid as int),
    cast(lastcommentid as int),
    cast(lastcomment as varchar),
    cast(lastcommentdate as timestamp),
    cast(lastcommentuser as varchar),
    cast(urgency as varchar),
    cast(defaultduedays as int),
    cast(keepduedatealignedwithpsd as boolean),
    cast(isautocreatedconstraint as boolean),
    cast(parentactionid as varchar),
    cast(parentaction as varchar),
    cast(float as varchar),
    cast(constraintplannedstartdate as timestamp),
    cast(completedbyuseremail as varchar),
    cast(assignedtouseremail as varchar),
    cast(assignedbyuseremail as varchar),
    cast(releasedonentityid as int),
    cast(referencenumber as varchar),
    cast(attachmentannotationid as varchar),
    cast(isrestrictedannotation as boolean),
    cast(isdeleted as boolean),
    cast(constrainttypedescription as varchar),
    cast(assignedtoprojectteamid as int),
    cast(assignedtoprojectteam as varchar),
    cast(simpleentityid as int),
    cast(ewpnumber as varchar),
    cast(ewpstatusid as int),
    cast(ewpstatus as varchar),
    cast(statusdate as varchar),
    cast(ewpdescription as varchar),
    cast(ewplongdescription as varchar),
    cast(ewpexternallink as varchar),
    cast(ewprevision as varchar),
    cast(criticalpath as boolean),
    cast(plannedstartdate as timestamp),
    cast(actualstartdate as timestamp),
    cast(plannedfinishdate as timestamp),
    cast(actualfinishdate as timestamp),
    cast(labels as varchar),
    cast(forecaststartdate as timestamp),
    cast(forecastfinishdate as timestamp),
    cast(documentid as varchar),
    cast(documentstatusid as int),
    cast(documentstatus as varchar),
    cast(documentdescription as varchar),
    cast(documentlongdescription as varchar),
    cast(documentexternallink as varchar),
    cast(documentrevision as varchar),
    cast(documentownercompanyid as varchar),
    cast(documentownercompany as varchar),
    cast(documenttypeid as int),
    cast(documenttype as varchar),
    cast(documentnumber as varchar),
    cast(attachmentcount as int),
    cast(mechanicalequipmentid as varchar),
    cast(mechanicalequipment as varchar),
    cast(unitcode as varchar),
    cast(areacode as varchar),
    cast(wbsid as int),
    cast(wbs as varchar),
    cast(contractgroupid as int),
    cast(contractgroup as varchar),
    cast(criticalpathcategoryid as varchar),
    cast(criticalpathcategory as varchar),
    cast(masterentityid as varchar),
    cast(releasedbyuserid as varchar),
    cast(releasedbyuser as varchar),
    cast(datereleased as timestamp),
    cast(leadengineeruserid as int),
    cast(constructionrepresentativeuserid as int),
    cast(leadengineer as varchar),
    cast(constructionrepresentative as varchar),
    cast(iwpnumber as varchar) as iwpsid,
    cast(subcwp as varchar),
    cast(deliveryteamid as varchar),
    cast(deliveryteam as varchar),
    cast(purposecategoryid as varchar),
    cast(purposecategory as varchar),
    cast(keyquantity as float),
    cast(unitofmeasureid as varchar),
    cast(uom as varchar),
    cast(datefirstconstraintcompleted as timestamp),
    cast(datefirstconstraintcreated as timestamp),
    cast(datelastconstraintcreated as timestamp),
    cast(plannedduration as varchar),
    cast(criticalpath2 as boolean),
    cast(plannedreleasedtoqualitydate as timestamp),
    cast(actualreleasedtoqualitydate as timestamp),
    cast(calendarstartdate as timestamp),
    cast(calendarenddate as timestamp),
    cast(projectphaseid as int),
    cast(projectphase as varchar),
    cast(plannedreleasedate as timestamp),
    cast(forecastreleasedate as timestamp),
    cast(cwaareareleaseid as varchar),
    cast(cwaarearelease as varchar),
    cast(drawingnumber as varchar),
    cast(drawingstatusid as int),
    cast(drawingstatus as varchar),
    cast(drawingdescription as varchar),
    cast(longdescription as varchar),
    cast(externallink as varchar),
    cast(revision as varchar),
    cast(revisiondate as timestamp),
    cast(drawingtypeid as int),
    cast(drawingtype as varchar),
    cast(dateissued as timestamp),
    cast(filename as varchar),
    cast(location as varchar),
    cast(percentdocumented as float),
    cast(percentdocumentedinclusive as float),
    cast(percentconstraintfree as float),
    cast(percentdelayfree as float),
    cast(percentapproved as float),
    cast(percentdeveloped as float),
    cast(drawingcompanyid as varchar),
    cast(drawingcompany as varchar),
    cast(sheet as varchar),
    cast(sourcedeleted as boolean),
    cast(sourceurn as varchar),
    cast(modelguid as varchar),
    cast(modelid as varchar),
    cast(hasreleasedversion as boolean),
    cast(hasworkingversion as boolean),
    cast(drawinghasrevisionattachment as boolean),
    cast(drawingrevisionattachmentispdf as boolean),
    cast(workingrevision as varchar),
    cast(openannotationcount as int),
    cast(manufacturer as varchar),
    cast(visibletoallusers as boolean),
    cast(rfi as varchar),
    cast(rfistatusid as int),
    cast(rfidescription as varchar),
    cast(rfistatus as varchar),
    cast(companycontactuserid as int),
    cast(companycontactuser as varchar),
    cast(scheduleimpactid as int),
    cast(scheduleimpact as varchar),
    cast(scheduleimpactcolor as varchar),
    cast(costimpactid as int),
    cast(costimpact as varchar),
    cast(costimpactcolor as varchar),
    cast(responsibleengineeruserid as int),
    cast(responsibleengineeruser as varchar),
    cast(reasonid as int),
    cast(reason as varchar),
    cast(resolutionid as varchar),
    cast(resolution as varchar),
    cast(documentrevisionsrequired as boolean),
    cast(rfitypeid as int),
    cast(rfitype as varchar),
    cast(workimpactid as varchar),
    cast(workimpact as varchar),
    cast(workimpactcolor as varchar),
    cast(disciplines as varchar),
    cast(subject as varchar),
    cast(openedbyuserid as int),
    cast(openedbyuser as varchar),
    cast(is_current as int),
    cast(eff_start_date as timestamp),
    cast(eff_end_date as timestamp)
from 
          {{ source('curated_vg_o3', 'curated_constraints') }}
where is_current = 1


--ALTER TABLE fact_o3_constraints ADD CONSTRAINT constraints_pk PRIMARY KEY (constraintpk);
