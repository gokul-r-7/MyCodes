---
SourceSystemId: sharepoint_curated
MetadataType: curated#vg_sharepoint#ptm_iso_tracker#job#iceberg
source:
  compute_engine: spark
  glue_options:
    connection_options: s3://${raw_bucket}/vg/sharepoint/parquet/vg_sharepoint_ptm_iso_tracker_sheet.parquet/
    connection_type: s3
    format: parquet
    transformation_ctx: vg_sharepoint-csv_xlsx_curated
  name: vg_sharepoint_csv_xlsx_curated
  spark_options:
    format: parquet
table_schema:
  columns:
  - column_data_type: string
    column_name: SR_NO
    comment: SR_NO
    data_classification: 
    nullable: true
    raw_column_name: sr_no
  - column_data_type: string
    column_name: DWG_NO
    comment: DWG_NO
    data_classification: 
    nullable: true
    raw_column_name: dwg_no
  - column_data_type: string
    column_name: DOC_NO
    comment: DOC_NO
    data_classification: 
    nullable: true
    raw_column_name: doc_no
  - column_data_type: string
    column_name: ISO_ID
    comment: ISO_ID
    data_classification: 
    nullable: true
    raw_column_name: iso_id
  - column_data_type: string
    column_name: CWP
    comment: CWP
    data_classification: 
    nullable: true
    raw_column_name: cwp
  - column_data_type: string
    column_name: LINE_ID
    comment: LINE_ID
    data_classification: 
    nullable: true
    raw_column_name: line_id
  - column_data_type: string
    column_name: LINE_SIZE
    comment: LINE_SIZE
    data_classification: 
    nullable: true
    raw_column_name: line_size
  - column_data_type: string
    column_name: SPEC
    comment: SPEC
    data_classification: 
    nullable: true
    raw_column_name: spec
  - column_data_type: string
    column_name: INSULATION
    comment: INSULATION
    data_classification: 
    nullable: true
    raw_column_name: insulation
  - column_data_type: string
    column_name: PID_NO
    comment: PID_NO
    data_classification: 
    nullable: true
    raw_column_name: pid_no
  - column_data_type: string
    column_name: REMARKS
    comment: REMARKS
    data_classification: 
    nullable: true
    raw_column_name: remarks
  - column_data_type: string
    column_name: MODELLING_STATUS
    comment: MODELLING_STATUS
    data_classification: 
    nullable: true
    raw_column_name: modelling_status
  - column_data_type: string
    column_name: LINE_MODELLED
    comment: LINE_MODELLED
    data_classification: 
    nullable: true
    raw_column_name: line_modelled
  - column_data_type: string
    column_name: IFH_PID_CHECK_COMPLETED
    comment: IFH_PID_CHECK_COMPLETED
    data_classification: 
    nullable: true
    raw_column_name: ifh_pid_check_completed
  - column_data_type: string
    column_name: 30_REVIEW_COMMENTS_UPDATED
    comment: 30_REVIEW_COMMENTS_UPDATED
    data_classification: 
    nullable: true
    raw_column_name: 30_review_comments_updated
  - column_data_type: string
    column_name: ISSUED_TO_STRESS
    comment: ISSUED_TO_STRESS
    data_classification: 
    nullable: true
    raw_column_name: issued_to_stress
  - column_data_type: string
    column_name: RETURNED_FROM_STRESS
    comment: RETURNED_FROM_STRESS
    data_classification: 
    nullable: true
    raw_column_name: returned_from_stress
  - column_data_type: string
    column_name: STRESS_INCORPORATION
    comment: STRESS_INCORPORATION
    data_classification: 
    nullable: true
    raw_column_name: stress_incorporation
  - column_data_type: string
    column_name: SUPPORTING_COMPLETED
    comment: SUPPORTING_COMPLETED
    data_classification: 
    nullable: true
    raw_column_name: supporting_completed
  - column_data_type: string
    column_name: INLINE_COMPONENT_DATA_UPDATED
    comment: INLINE_COMPONENT_DATA_UPDATED
    data_classification: 
    nullable: true
    raw_column_name: inline_component_data_updated
  - column_data_type: string
    column_name: PRELIMINARY_VENDOR_DATA_UPDATED
    comment: PRELIMINARY_VENDOR_DATA_UPDATED
    data_classification: 
    nullable: true
    raw_column_name: preliminary_vendor_data_updated
  - column_data_type: string
    column_name: LINE_MADE_CLASH_FREE_DATA_CONSISTENCY_CHECK_CLEARED
    comment: LINE_MADE_CLASH_FREE_DATA_CONSISTENCY_CHECK_CLEARED
    data_classification: 
    nullable: true
    raw_column_name: line_made_clash_free_data_consistency_check_cleared
  - column_data_type: string
    column_name: 60_MODEL_REVIEW_COMMENTS_UPDATED
    comment: 60_MODEL_REVIEW_COMMENTS_UPDATED
    data_classification: 
    nullable: true
    raw_column_name: 60_model_review_comments_updated
  - column_data_type: string
    column_name: ISO_EXTRACTION_FOR_DESIGNER_SELF_CHECK_WITH_APPROVED_MOC_AVAILABLE_VENDOR_DATA
    comment: ISO_EXTRACTION_FOR_DESIGNER_SELF_CHECK_WITH_APPROVED_MOC_AVAILABLE_VENDOR_DATA
    data_classification: 
    nullable: true
    raw_column_name: iso_extraction_for_designer_self_check_with_approved_moc_available_vendor_data
  - column_data_type: string
    column_name: PIPING_MOC_PREPARED_IF_APPLICABLE
    comment: PIPING_MOC_PREPARED_IF_APPLICABLE
    data_classification: 
    nullable: true
    raw_column_name: piping_moc_prepared_if_applicable
  - column_data_type: string
    column_name: PIPING_CHECK_WITH_CUT_OFF_PID
    comment: PIPING_CHECK_WITH_CUT_OFF_PID
    data_classification: 
    nullable: true
    raw_column_name: piping_check_with_cut_off_pid
  - column_data_type: string
    column_name: PIPING_CHECKER_COMMENTS_UPDATED_FINAL_VENDOR_DATA_COMMENTS_RECEIVED
    comment: PIPING_CHECKER_COMMENTS_UPDATED_FINAL_VENDOR_DATA_COMMENTS_RECEIVED
    data_classification: 
    nullable: true
    raw_column_name: piping_checker_comments_updated_final_vendor_data_comments_received
  - column_data_type: string
    column_name: ISSUED_TO_SQUAD_CHECK
    comment: ISSUED_TO_SQUAD_CHECK
    data_classification: 
    nullable: true
    raw_column_name: issued_to_squad_check
  - column_data_type: string
    column_name: CHECK_SQUAD_CHECK_BB_SESSION
    comment: CHECK_SQUAD_CHECK_BB_SESSION
    data_classification: 
    nullable: true
    raw_column_name: check_squad_check_bb_session
  - column_data_type: string
    column_name: INTERNAL_LOT
    comment: INTERNAL_LOT
    data_classification: 
    nullable: true
    raw_column_name: internal_lot
  - column_data_type: string
    column_name: SQUAD_CHECK_COMPLETED
    comment: SQUAD_CHECK_COMPLETED
    data_classification: 
    nullable: true
    raw_column_name: squad_check_completed
  - column_data_type: string
    column_name: YES_IF_90_MODEL_REVIEW_APPLICABLE
    comment: YES_IF_90_MODEL_REVIEW_APPLICABLE
    data_classification: 
    nullable: true
    raw_column_name: yes_if_90_model_review_applicable
  - column_data_type: string
    column_name: 90_REVIEW_COMMENTS_UPDATED
    comment: 90_REVIEW_COMMENTS_UPDATED
    data_classification: 
    nullable: true
    raw_column_name: 90_review_comments_updated
  - column_data_type: string
    column_name: COMMENT_INCORPORATION_OF_FINAL_COMMENTS
    comment: COMMENT_INCORPORATION_OF_FINAL_COMMENTS
    data_classification: 
    nullable: true
    raw_column_name: comment_incorporation_of_final_comments
  - column_data_type: string
    column_name: FINAL_ISOMETRIC_BACK_CHECKING_WRT_FROZEN_PID
    comment: FINAL_ISOMETRIC_BACK_CHECKING_WRT_FROZEN_PID
    data_classification: 
    nullable: true
    raw_column_name: final_isometric_back_checking_wrt_frozen_pid
  - column_data_type: string
    column_name: AFC_ISOMETRIC_EXTRACTED_AND_ISSUED_TO_SIGN_OFF
    comment: AFC_ISOMETRIC_EXTRACTED_AND_ISSUED_TO_SIGN_OFF
    data_classification: 
    nullable: true
    raw_column_name: afc_isometric_extracted_and_issued_to_sign_off
  - column_data_type: string
    column_name: AFC_ISOMETRIC_TRANSMITTAL_ISSUED
    comment: AFC_ISOMETRIC_TRANSMITTAL_ISSUED
    data_classification: 
    nullable: true
    raw_column_name: afc_isometric_transmittal_issued
  - column_data_type: string
    column_name: HOLD
    comment: HOLD
    data_classification: 
    nullable: true
    raw_column_name: hold
  - column_data_type: string
    column_name: HOLD_REMARKS
    comment: HOLD_REMARKS
    data_classification: 
    nullable: true
    raw_column_name: hold_remarks
  - column_data_type: string
    column_name: PROCESS
    comment: PROCESS
    data_classification: 
    nullable: true
    raw_column_name: process
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE
    comment: HOLD_INITIATION_DATE
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date
  - column_data_type: string
    column_name: MECHANICAL
    comment: MECHANICAL
    data_classification: 
    nullable: true
    raw_column_name: mechanical
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_1
    comment: HOLD_INITIATION_DATE_1
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_1
  - column_data_type: string
    column_name: INSTRUMENTATION
    comment: INSTRUMENTATION
    data_classification: 
    nullable: true
    raw_column_name: instrumentation
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_2
    comment: HOLD_INITIATION_DATE_2
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_2
  - column_data_type: string
    column_name: STRUCTURAL
    comment: STRUCTURAL
    data_classification: 
    nullable: true
    raw_column_name: structural
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_3
    comment: HOLD_INITIATION_DATE_3
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_3
  - column_data_type: string
    column_name: PIPING_STRESS
    comment: PIPING_STRESS
    data_classification: 
    nullable: true
    raw_column_name: piping_stress
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_4
    comment: HOLD_INITIATION_DATE_4
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_4
  - column_data_type: string
    column_name: PIPING_SPEC_MATERIAL_RELATED
    comment: PIPING_SPEC_MATERIAL_RELATED
    data_classification: 
    nullable: true
    raw_column_name: piping_spec_material_related
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_5
    comment: HOLD_INITIATION_DATE_5
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_5
  - column_data_type: string
    column_name: REMARKS_1
    comment: REMARKS_1
    data_classification: 
    nullable: true
    raw_column_name: remarks_1
  - column_data_type: string
    column_name: TARGET_TO_STRESS_COMPLETION_DATE
    comment: TARGET_TO_STRESS_COMPLETION_DATE
    data_classification: 
    nullable: true
    raw_column_name: target_to_stress_completion_date
  - column_data_type: string
    column_name: TARGET_TO_STRUCTURAL_COMPLETION_DATE
    comment: TARGET_TO_STRUCTURAL_COMPLETION_DATE
    data_classification: 
    nullable: true
    raw_column_name: target_to_structural_completion_date
  - column_data_type: string
    column_name: TARGET_ISO_LOCK_DATE
    comment: TARGET_ISO_LOCK_DATE
    data_classification: 
    nullable: true
    raw_column_name: target_iso_lock_date
  - column_data_type: string
    column_name: TARGET_AFC_DATE
    comment: TARGET_AFC_DATE
    data_classification: 
    nullable: true
    raw_column_name: target_afc_date
  - column_data_type: string
    column_name: PROCESS_CRITICAL_LINES
    comment: PROCESS_CRITICAL_LINES
    data_classification: 
    nullable: true
    raw_column_name: process_critical_lines
  - column_data_type: string
    column_name: STRESS_CALCULATION_NUMBER
    comment: STRESS_CALCULATION_NUMBER
    data_classification: 
    nullable: true
    raw_column_name: stress_calculation_number
  - column_data_type: string
    column_name: STRESS_CRITICAL_LEVEL
    comment: STRESS_CRITICAL_LEVEL
    data_classification: 
    nullable: true
    raw_column_name: stress_critical_level
  - column_data_type: string
    column_name: ISSUED_TO_STRESS_DATE
    comment: ISSUED_TO_STRESS_DATE
    data_classification: 
    nullable: true
    raw_column_name: issued_to_stress_date
  - column_data_type: string
    column_name: RETURNED_FROM_STRESS_DATE
    comment: RETURNED_FROM_STRESS_DATE
    data_classification: 
    nullable: true
    raw_column_name: returned_from_stress_date
  - column_data_type: string
    column_name: HO_REMARKS
    comment: HO_REMARKS
    data_classification: 
    nullable: true
    raw_column_name: ho_remarks
  - column_data_type: string
    column_name: FORECAST
    comment: FORECAST
    data_classification: 
    nullable: true
    raw_column_name: forecast
  - column_data_type: string
    column_name: PIPING_ISSUED_DOCR
    comment: PIPING_ISSUED_DOCR
    data_classification: 
    nullable: true
    raw_column_name: piping_issued_docr
  - column_data_type: string
    column_name: TO_HO_FOR_FINAL_SIGN
    comment: TO_HO_FOR_FINAL_SIGN
    data_classification: 
    nullable: true
    raw_column_name: to_ho_for_final_sign
  - column_data_type: string
    column_name: TO_HO_FOR_FINAL_SIGN_BB
    comment: TO_HO_FOR_FINAL_SIGN_BB
    data_classification: 
    nullable: true
    raw_column_name: to_ho_for_final_sign_bb
  - column_data_type: string
    column_name: COMMENTS_RECEIVED_DURING_SIGN_OFF
    comment: COMMENTS_RECEIVED_DURING_SIGN_OFF
    data_classification: 
    nullable: true
    raw_column_name: comments_received_during_sign_off
  - column_data_type: string
    column_name: AFC_ISOMETRIC_EXTRACTED_AND_ISSUED_TO_DCC
    comment: AFC_ISOMETRIC_EXTRACTED_AND_ISSUED_TO_DCC
    data_classification: 
    nullable: true
    raw_column_name: afc_isometric_extracted_and_issued_to_dcc
  - column_data_type: string
    column_name: WORKPACK_NUMBER
    comment: WORKPACK_NUMBER
    data_classification: 
    nullable: true
    raw_column_name: workpack_number
  - column_data_type: string
    column_name: PHASE
    comment: PHASE
    data_classification: 
    nullable: true
    raw_column_name: phase
  - column_data_type: string
    column_name: CONST_TYPE
    comment: CONST_TYPE
    data_classification: 
    nullable: true
    raw_column_name: const_type
  - column_data_type: string
    column_name: MISC_HOLD
    comment: MISC_HOLD
    data_classification: 
    nullable: true
    raw_column_name: misc_hold
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_6
    comment: HOLD_INITIATION_DATE_6
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_6
  - column_data_type: string
    column_name: FIV_AIV_SURGE_HOLD
    comment: FIV_AIV_SURGE_HOLD
    data_classification: 
    nullable: true
    raw_column_name: fiv_aiv_surge_hold
  - column_data_type: string
    column_name: HOLD_INITIATION_DATE_7
    comment: HOLD_INITIATION_DATE_7
    data_classification: 
    nullable: true
    raw_column_name: hold_initiation_date_7
  - column_data_type: string
    column_name: ISOMETRICS_ISSUED_FOR_EXTRACTION
    comment: ISOMETRICS_ISSUED_FOR_EXTRACTION
    data_classification: 
    nullable: true
    raw_column_name: isometrics_issued_for_extraction
  - column_data_type: string
    column_name: DESIGNER
    comment: DESIGNER
    data_classification: 
    nullable: true
    raw_column_name: designer
  - column_data_type: string
    column_name: EXTRACTION_COMPLETED
    comment: EXTRACTION_COMPLETED
    data_classification: 
    nullable: true
    raw_column_name: extraction_completed
  - column_data_type: string
    column_name: HOLD_1
    comment: HOLD_1
    data_classification: 
    nullable: true
    raw_column_name: hold_1
  - column_data_type: string
    column_name: ISO_STATUS_DELETED_SUPERSEDED_ETC
    comment: ISO_STATUS_DELETED_SUPERSEDED_ETC
    data_classification: 
    nullable: true
    raw_column_name: iso_status_deleted_superseded_etc
  - column_data_type: string
    column_name: 60_CLIENT_MODEL_REVIEW_COMPLETE
    comment: 60_CLIENT_MODEL_REVIEW_COMPLETE
    data_classification: 
    nullable: true
    raw_column_name: 60_client_model_review_complete
  - column_data_type: string
    column_name: BTR_PIPING_DESIGN_ISO_INTERSQUAD_REVIEWER
    comment: BTR_PIPING_DESIGN_ISO_INTERSQUAD_REVIEWER
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_design_iso_intersquad_reviewer
  - column_data_type: string
    column_name: BTR_PIPING_DESIGN_ISO_INTERSQUAD_COMPLETE
    comment: BTR_PIPING_DESIGN_ISO_INTERSQUAD_COMPLETE
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_design_iso_intersquad_complete
  - column_data_type: string
    column_name: BTR_PIPING_DESIGN_ISO_IFC_APPROVAL_NAME
    comment: BTR_PIPING_DESIGN_ISO_IFC_APPROVAL_NAME
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_design_iso_ifc_approval_name
  - column_data_type: string
    column_name: BTR_PIPING_DESIGN_ISO_IFC_APPROVAL_DATE
    comment: BTR_PIPING_DESIGN_ISO_IFC_APPROVAL_DATE
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_design_iso_ifc_approval_date
  - column_data_type: string
    column_name: BTR_PIPING_DESIGN_IFC_REMARKS
    comment: BTR_PIPING_DESIGN_IFC_REMARKS
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_design_ifc_remarks
  - column_data_type: string
    column_name: IFC_LOT
    comment: IFC_LOT
    data_classification: 
    nullable: true
    raw_column_name: ifc_lot
  - column_data_type: string
    column_name: BTR_PIPING_ENG_ISO_IFC_APPROVAL
    comment: BTR_PIPING_ENG_ISO_IFC_APPROVAL
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_eng_iso_ifc_approval
  - column_data_type: string
    column_name: BTR_PIPING_ENG_IFC_REMARKS
    comment: BTR_PIPING_ENG_IFC_REMARKS
    data_classification: 
    nullable: true
    raw_column_name: btr_piping_eng_ifc_remarks
  - column_data_type: string
    column_name: PRIORITY
    comment: PRIORITY
    data_classification: 
    nullable: true
    raw_column_name: priority
  - column_data_type: string
    column_name: REVISION_REQUIRED
    comment: REVISION_REQUIRED
    data_classification: 
    nullable: true
    raw_column_name: revision_required
  - column_data_type: string
    column_name: REVISION_DESCRIPTION
    comment: REVISION_DESCRIPTION
    data_classification: 
    nullable: true
    raw_column_name: revision_description
  - column_data_type: string
    column_name: ADDED_TO_REVISION_LOG
    comment: ADDED_TO_REVISION_LOG
    data_classification: 
    nullable: true
    raw_column_name: added_to_revision_log
  - column_data_type: string
    column_name: ARCHIVED_DWG_NO
    comment: ARCHIVED_DWG_NO
    data_classification: 
    nullable: true
    raw_column_name: archived_dwg_no
  - column_data_type: string
    column_name: ARCHIVED_DOC_NO
    comment: ARCHIVED_DOC_NO
    data_classification: 
    nullable: true
    raw_column_name: archived_doc_no
  - column_data_type: string
    column_name: ARCHIVED_ISO_ID
    comment: ARCHIVED_ISO_ID
    data_classification: 
    nullable: true
    raw_column_name: archived_iso_id
  - column_data_type: string
    column_name: ARCHIVED_CWP
    comment: ARCHIVED_CWP
    data_classification: 
    nullable: true
    raw_column_name: archived_cwp
  - column_data_type: string
    column_name: ARCHIVED_LINE_ID
    comment: ARCHIVED_LINE_ID
    data_classification: 
    nullable: true
    raw_column_name: archived_line_id
  - column_data_type: string
    column_name: TBD
    comment: TBD
    data_classification: 
    nullable: true
    raw_column_name: tbd
  - column_data_type: string
    column_name: MISC
    comment: MISC
    data_classification: 
    nullable: true
    raw_column_name: misc
  - column_data_type: string
    column_name: PTM1_TO_PTM2_REPLICATION_UNIQUE_IDENTIFIERS
    comment: PTM1_TO_PTM2_REPLICATION_UNIQUE_IDENTIFIERS
    data_classification: 
    nullable: true
    raw_column_name: ptm1_to_ptm2_replication_unique_identifiers
  - column_data_type: string
    column_name: PTM1_TO_PTM2_REPLICATION_PHASE_2_DIFFERENCES_VALVING_ROUTING_ETC
    comment: PTM1_TO_PTM2_REPLICATION_PHASE_2_DIFFERENCES_VALVING_ROUTING_ETC
    data_classification: 
    nullable: true
    raw_column_name: ptm1_to_ptm2_replication_phase_2_differences_valving_routing_etc
  - column_data_type: string
    column_name: PTM1_TO_PTM2_REPLICATION_REMARKS
    comment: PTM1_TO_PTM2_REPLICATION_REMARKS
    data_classification: 
    nullable: true
    raw_column_name: ptm1_to_ptm2_replication_remarks
  schema_properties:
    enforce: true
    rename_columns: true
target:
  compute_engine: spark
  iceberg_properties:
    database_name: ${database_prefix}_vg_sharepoint
    iceberg_configuration:
      create_table: true
      iceberg_catalog_warehouse: ${curated_bucket}/vg/sharepoint/ptm_iso_tracker/
      table_properties:
        format-version: '2'
        write.format.default: parquet
    table_name: curated_ptm_iso_tracker
  name: curated_vg_sharepoint_ptm_iso_tracker
  load_type: append
  spark_options:
    format: iceberg
    options:
      path: s3://${curated_bucket}/vg/sharepoint/ptm_iso_tracker
transforms:
- rename_column: true
  transform: rename_columns
- select_columns: true
  transform: select_columns_from_config_file
- change_types: true
  transform: change_data_types
- column_name: EXECUTION_DATE
  date_format: yyyy-MM-dd
  transform: add_run_date
- sql: SELECT *, 'vg_sharepoint' as SOURCE_SYSTEM_NAME FROM temp_df_static
  temp_view_name: temp_df_static
  transform: custom_sql

