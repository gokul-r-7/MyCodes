{%- set run_date = "CURRENT_TIMESTAMP()" -%}
{{
    config(
        materialized='incremental',
        incremental_strategy='insert_overwrite',
        file_format='iceberg',
        iceberg_expire_snapshots='False', 
        custom_location=target.location ~ 'transformed_omie_combo/',
        table_properties={'write.target-file-size-bytes': '268435456'},
        on_schema_change='append_new_columns',
        full_refresh=true
        ) 
}}


select
    id,
    cast(p01 as varchar(2000)) as p01,
    cast(p02 as varchar(2000)) as p02,
    cast(p03 as varchar(2000)) as p03,
    cast(p04 as varchar(2000)) as p04,
    cast(p05 as varchar(2000)) as p05,
    cast(p06 as varchar(2000)) as p06,
    cast(p07 as varchar(2000)) as p07,
    cast(p08 as varchar(2000)) as p08,
    cast(p09 as varchar(2000)) as p09,
    cast(p10 as varchar(2000)) as p10,
    cast(p11 as varchar(2000)) as p11,
    cast(p12 as varchar(2000)) as p12,
    cast(p13 as varchar(2000)) as p13,
    cast(p14 as varchar(2000)) as p14,
    cast(p15 as varchar(2000)) as p15,
    cast(p16 as varchar(2000)) as p16,
    cast(p17 as varchar(2000)) as p17,
    cast(p18 as varchar(2000)) as p18,
    cast(p19 as varchar(2000)) as p19,
    cast(p20 as varchar(2000)) as p20,
    cast(p21 as varchar(2000)) as p21,
    cast(p22 as varchar(2000)) as p22,
    cast(p23 as varchar(2000)) as p23,
    cast(p24 as varchar(2000)) as p24,
    cast(p25 as varchar(2000)) as p25,
    cast(p26 as varchar(2000)) as p26,
    cast(p27 as varchar(2000)) as p27,
    cast(p28 as varchar(2000)) as p28,
    cast(p29 as varchar(2000)) as p29,
    cast(p30 as varchar(2000)) as p30,
    cast(p31 as varchar(2000)) as p31,
    cast(p32 as varchar(2000)) as p32,
    cast(p33 as varchar(2000)) as p33,
    cast(p34 as varchar(2000)) as p34,
    cast(p35 as varchar(2000)) as p35,
    cast(p36 as varchar(2000)) as p36,
    cast(p37 as varchar(2000)) as p37,
    cast(p38 as varchar(2000)) as p38,
    cast(p39 as varchar(2000)) as p39,
    cast(p40 as varchar(2000)) as p40,
    cast(p41 as varchar(2000)) as p41,
    cast(p42 as varchar(2000)) as p42,
    cast(p43 as varchar(2000)) as p43,
    cast(p44 as varchar(2000)) as p44,
    cast(p45 as varchar(2000)) as p45,
    cast(p46 as varchar(2000)) as p46,
    cast(p47 as varchar(2000)) as p47,
    cast(p48 as varchar(2000)) as p48,
    cast(p49 as varchar(2000)) as p49,
    cast(p50 as varchar(2000)) as p50,
    cast(p51 as varchar(2000)) as p51,
    cast(p52 as varchar(2000)) as p52,
    cast(p53 as varchar(2000)) as p53,
    cast(p54 as varchar(2000)) as p54,
    cast(p55 as varchar(2000)) as p55,
    cast(p56 as varchar(2000)) as p56,
    cast(p57 as varchar(2000)) as p57,
    cast(p58 as varchar(2000)) as p58,
    cast(p59 as varchar(2000)) as p59,
    cast(p60 as varchar(2000)) as p60,
    cast(p61 as varchar(2000)) as p61,
    cast(p62 as varchar(2000)) as p62,
    cast(p63 as varchar(2000)) as p63,
    cast(p64 as varchar(2000)) as p64,
    cast(p65 as varchar(2000)) as p65,
    cast(p66 as varchar(2000)) as p66,
    cast(p67 as varchar(2000)) as p67,
    cast(p68 as varchar(2000)) as p68,
    cast(p69 as varchar(2000)) as p69,
    cast(p70 as varchar(2000)) as p70,
    cast(p71 as varchar(2000)) as p71,
    cast(p72 as varchar(2000)) as p72,
    cast(p73 as varchar(2000)) as p73,
    cast(p74 as varchar(2000)) as p74,
    cast(p75 as varchar(2000)) as p75,
    cast(p76 as varchar(2000)) as p76,
    cast(p77 as varchar(2000)) as p77,
    cast(p78 as varchar(2000)) as p78,
    cast(p79 as varchar(2000)) as p79,
    cast(p80 as varchar(2000)) as p80,
    cast(p81 as varchar(2000)) as p81,
    cast(p82 as varchar(2000)) as p82,
    cast(p83 as varchar(2000)) as p83,
    cast(p84 as varchar(2000)) as p84,
    cast(p85 as varchar(2000)) as p85,
    cast(p86 as varchar(2000)) as p86,
    cast(p87 as varchar(2000)) as p87,
    cast(p88 as varchar(2000)) as p88,
    cast(p89 as varchar(2000)) as p89,
    cast(p90 as varchar(2000)) as p90,
    cast(p91 as varchar(2000)) as p91,
    cast(p92 as varchar(2000)) as p92,
    cast(p93 as varchar(2000)) as p93,
    cast(p94 as varchar(2000)) as p94,
    cast(p95 as varchar(2000)) as p95,
    cast(p96 as varchar(2000)) as p96,
    cast(p97 as varchar(2000)) as p97,
    cast(p98 as varchar(2000)) as p98,
    cast(p99 as varchar(2000)) as p99,
    order,
    updated_by_id,
    cast(mdate as timestamp) as mdate,
    created_by_id,
    cast(cdate as timestamp) as cdate,
    disabled,
    deleted,
    cast(execution_date as date) as extracted_date,
	source_system_name,
    {{run_date}} as model_created_date,
    {{run_date}} as model_updated_date,
    {{ generate_load_id(model) }} as model_load_id,
    cast('VGCP2' as varchar(30)) as project_code
from
    {{ source('curated_omie', 'curated_combo') }}
