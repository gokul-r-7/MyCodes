SourceSystemId: ecosys_curated
MetadataType: curated#ecosys#exchange_rates#job#iceberg
source:
  compute_engine: spark
  glue_options:
    connection_options: s3://${raw_bucket}/project_control/ecosys/exchange_rates/
    connection_type: s3
    format: parquet
    transformation_ctx: ecosys-exchange-rates
  name: ecosys_exchange_rates
  spark_options:
    format: parquet
table_schema:
  columns:
  - column_data_type: string
    column_name: exchange_rates_aed
    comment: exchange_rates_aed
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_aed
  - column_data_type: string
    column_name: exchange_rates_aoa
    comment: exchange_rates_aoa
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_aoa
  - column_data_type: string
    column_name: exchange_rates_ars
    comment: exchange_rates_ars
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_ars
  - column_data_type: string
    column_name: exchange_rates_aud
    comment: exchange_rates_aud
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_aud
  - column_data_type: string
    column_name: exchange_rates_azn
    comment: exchange_rates_azn
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_azn
  - column_data_type: string
    column_name: exchange_rates_bgn
    comment: exchange_rates_bgn
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_bgn
  - column_data_type: string
    column_name: exchange_rates_bhd
    comment: exchange_rates_bhd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_bhd
  - column_data_type: string
    column_name: exchange_rates_bnd
    comment: exchange_rates_bnd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_bnd
  - column_data_type: string
    column_name: exchange_rates_brl
    comment: exchange_rates_brl
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_brl
  - column_data_type: string
    column_name: exchange_rates_cad
    comment: exchange_rates_cad
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_cad
  - column_data_type: string
    column_name: exchange_rates_chf
    comment: exchange_rates_chf
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_chf
  - column_data_type: string
    column_name: exchange_rates_clp
    comment: exchange_rates_clp
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_clp
  - column_data_type: string
    column_name: exchange_rates_cny
    comment: exchange_rates_cny
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_cny
  - column_data_type: string
    column_name: exchange_rates_cop
    comment: exchange_rates_cop
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_cop
  - column_data_type: string
    column_name: exchange_rates_czk
    comment: exchange_rates_czk
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_czk
  - column_data_type: string
    column_name: exchange_rates_dkk
    comment: exchange_rates_dkk
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_dkk
  - column_data_type: string
    column_name: exchange_rates_egp
    comment: exchange_rates_egp
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_egp
  - column_data_type: string
    column_name: exchange_rates_eur
    comment: exchange_rates_eur
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_eur
  - column_data_type: string
    column_name: exchange_rates_exchangeratetableidname
    comment: exchange_rates_exchangeratetableidname
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_exchangeratetableidname
  - column_data_type: string
    column_name: exchange_rates_gbp
    comment: exchange_rates_gbp
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_gbp
  - column_data_type: string
    column_name: exchange_rates_ghs
    comment: exchange_rates_ghs
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_ghs
  - column_data_type: string
    column_name: exchange_rates_hkd
    comment: exchange_rates_hkd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_hkd
  - column_data_type: string
    column_name: exchange_rates_idr
    comment: exchange_rates_idr
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_idr
  - column_data_type: string
    column_name: exchange_rates_inr
    comment: exchange_rates_inr
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_inr
  - column_data_type: string
    column_name: exchange_rates_iqd
    comment: exchange_rates_iqd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_iqd
  - column_data_type: string
    column_name: exchange_rates_irr
    comment: exchange_rates_irr
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_irr
  - column_data_type: string
    column_name: exchange_rates_jmd
    comment: exchange_rates_jmd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_jmd
  - column_data_type: string
    column_name: exchange_rates_jod
    comment: exchange_rates_jod
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_jod
  - column_data_type: string
    column_name: exchange_rates_jpy
    comment: exchange_rates_jpy
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_jpy
  - column_data_type: string
    column_name: exchange_rates_kes
    comment: exchange_rates_kes
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_kes
  - column_data_type: string
    column_name: exchange_rates_kgs
    comment: exchange_rates_kgs
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_kgs
  - column_data_type: string
    column_name: exchange_rates_krw
    comment: exchange_rates_krw
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_krw
  - column_data_type: string
    column_name: exchange_rates_kwd
    comment: exchange_rates_kwd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_kwd
  - column_data_type: string
    column_name: exchange_rates_kzt
    comment: exchange_rates_kzt
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_kzt
  - column_data_type: string
    column_name: exchange_rates_lyd
    comment: exchange_rates_lyd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_lyd
  - column_data_type: string
    column_name: exchange_rates_mad
    comment: exchange_rates_mad
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_mad
  - column_data_type: string
    column_name: exchange_rates_mnt
    comment: exchange_rates_mnt
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_mnt
  - column_data_type: string
    column_name: exchange_rates_mxn
    comment: exchange_rates_mxn
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_mxn
  - column_data_type: string
    column_name: exchange_rates_myr
    comment: exchange_rates_myr
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_myr
  - column_data_type: string
    column_name: exchange_rates_mzn
    comment: exchange_rates_mzn
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_mzn
  - column_data_type: string
    column_name: exchange_rates_nad
    comment: exchange_rates_nad
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_nad
  - column_data_type: string
    column_name: exchange_rates_ngn
    comment: exchange_rates_ngn
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_ngn
  - column_data_type: string
    column_name: exchange_rates_nok
    comment: exchange_rates_nok
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_nok
  - column_data_type: string
    column_name: exchange_rates_nzd
    comment: exchange_rates_nzd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_nzd
  - column_data_type: string
    column_name: exchange_rates_omr
    comment: exchange_rates_omr
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_omr
  - column_data_type: string
    column_name: exchange_rates_pen
    comment: exchange_rates_pen
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_pen
  - column_data_type: string
    column_name: exchange_rates_pgk
    comment: exchange_rates_pgk
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_pgk
  - column_data_type: string
    column_name: exchange_rates_php
    comment: exchange_rates_php
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_php
  - column_data_type: string
    column_name: exchange_rates_pln
    comment: exchange_rates_pln
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_pln
  - column_data_type: string
    column_name: exchange_rates_qar
    comment: exchange_rates_qar
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_qar
  - column_data_type: string
    column_name: exchange_rates_ron
    comment: exchange_rates_ron
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_ron
  - column_data_type: string
    column_name: exchange_rates_rub
    comment: exchange_rates_rub
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_rub
  - column_data_type: string
    column_name: exchange_rates_sar
    comment: exchange_rates_sar
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_sar
  - column_data_type: string
    column_name: exchange_rates_sek
    comment: exchange_rates_sek
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_sek
  - column_data_type: string
    column_name: exchange_rates_sgd
    comment: exchange_rates_sgd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_sgd
  - column_data_type: string
    column_name: exchange_rates_skk
    comment: exchange_rates_skk
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_skk
  - column_data_type: string
    column_name: exchange_rates_syp
    comment: exchange_rates_syp
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_syp
  - column_data_type: string
    column_name: exchange_rates_startminorperiod
    comment: exchange_rates_startminorperiod
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_startminorperiod
  - column_data_type: string
    column_name: exchange_rates_thb
    comment: exchange_rates_thb
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_thb
  - column_data_type: string
    column_name: exchange_rates_tnd
    comment: exchange_rates_tnd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_tnd
  - column_data_type: string
    column_name: exchange_rates_try
    comment: exchange_rates_try
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_try
  - column_data_type: string
    column_name: exchange_rates_ttd
    comment: exchange_rates_ttd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_ttd
  - column_data_type: string
    column_name: exchange_rates_tzs
    comment: exchange_rates_tzs
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_tzs
  - column_data_type: string
    column_name: exchange_rates_uah
    comment: exchange_rates_uah
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_uah
  - column_data_type: string
    column_name: exchange_rates_usd
    comment: exchange_rates_usd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_usd
  - column_data_type: string
    column_name: exchange_rates_uyu
    comment: exchange_rates_uyu
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_uyu
  - column_data_type: string
    column_name: exchange_rates_uzs
    comment: exchange_rates_uzs
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_uzs
  - column_data_type: string
    column_name: exchange_rates_vef
    comment: exchange_rates_vef
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_vef
  - column_data_type: string
    column_name: exchange_rates_vnd
    comment: exchange_rates_vnd
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_vnd
  - column_data_type: string
    column_name: exchange_rates_xaf
    comment: exchange_rates_xaf
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_xaf
  - column_data_type: string
    column_name: exchange_rates_xpf
    comment: exchange_rates_xpf
    data_classification: null
    nullable: true
    raw_columnname: exchange_rates_xpf
  - column_data_type: string
    column_name: exchange_rates_zar
    comment: exchange_rates_zar
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_zar
  - column_data_type: string
    column_name: exchange_rates_zmk
    comment: exchange_rates_zmk
    data_classification: null
    nullable: true
    raw_column_name: exchange_rates_zmk
  schema_properties:
    enforce: false
    # primary_key: []
    rename_columns: false
target:
  compute_engine: spark
  iceberg_properties:
    database_name: ${database_prefix}_project_control_ecosys_curated
    iceberg_configuration:
      create_table: true
      iceberg_catalog_warehouse: ${curated_bucket}/project_control/ecosys/exchange_rates/
      table_properties:
        format-version: '2'
        write.format.default: parquet
    table_name: curated_ecosys_exchange_rates
  load_type: full_load
  name: ecosys_exchange_rates
  spark_options:
    format: iceberg
    options:
      path: s3://${curated_bucket}/project_control/ecosys/exchange_rates
transforms:
- column_name: EXECUTION_DATE
  date_format: yyyy-MM-dd  HH:mm:ss
  transform: add_run_date
- sql: SELECT *, 'ecosys' as SOURCE_SYSTEM_NAME FROM temp_df_static
  temp_view_name: temp_df_static
  transform: custom_sql
