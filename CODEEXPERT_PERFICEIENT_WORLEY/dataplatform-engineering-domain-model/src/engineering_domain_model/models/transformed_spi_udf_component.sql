{%- set run_date = "CURRENT_TIMESTAMP()" -%}
{{
    config(
        materialized='incremental',
        incremental_strategy='insert_overwrite',
        file_format='iceberg',
        iceberg_expire_snapshots='False', 
        custom_location=target.location ~ 'transformed_spi_udf_component/',
        table_properties={'write.target-file-size-bytes': '268435456'},
        on_schema_change='append_new_columns',
        full_refresh=true
        ) 
}}


select
    cast(cmpnt_id as decimal(38, 0)) as cmpnt_id,
    cast(proj_id as decimal(38, 0)) as proj_id,
    cast(site_id as decimal(38, 0)) as site_id,
    cast(chg_num as decimal(38, 0)) as chg_num,
    cast(plant_id as decimal(38, 0)) as plant_id,
    cast(area_id as decimal(38, 0)) as area_id,
    cast(unit_id as decimal(38, 0)) as unit_id,
    cast(chg_status as varchar(1)) as chg_status,
    cast(user_name as varchar(30)) as user_name,
    cast(chg_date as date) as chg_date,
    cast(udf_c01 as varchar(500)) as udf_c01,
    cast(udf_c02 as varchar(500)) as udf_c02,
    cast(udf_c03 as varchar(500)) as udf_c03,
    cast(udf_c04 as varchar(500)) as udf_c04,
    cast(udf_c05 as varchar(500)) as udf_c05,
    cast(udf_c06 as varchar(500)) as udf_c06,
    cast(udf_c07 as varchar(500)) as udf_c07,
    cast(udf_c08 as varchar(500)) as udf_c08,
    cast(udf_c09 as varchar(500)) as udf_c09,
    cast(udf_c10 as varchar(500)) as udf_c10,
    cast(udf_c11 as varchar(500)) as udf_c11,
    cast(udf_c12 as varchar(500)) as udf_c12,
    cast(udf_c13 as varchar(500)) as udf_c13,
    cast(udf_c14 as varchar(500)) as udf_c14,
    cast(udf_c15 as varchar(500)) as udf_c15,
    cast(udf_c16 as varchar(500)) as udf_c16,
    cast(udf_c17 as varchar(500)) as udf_c17,
    cast(udf_c18 as varchar(500)) as udf_c18,
    cast(udf_c19 as varchar(500)) as udf_c19,
    cast(udf_c20 as varchar(500)) as udf_c20,
    cast(udf_c21 as varchar(500)) as udf_c21,
    cast(udf_c22 as varchar(500)) as udf_c22,
    cast(udf_c23 as varchar(500)) as udf_c23,
    cast(udf_c24 as varchar(500)) as udf_c24,
    cast(udf_c25 as varchar(500)) as udf_c25,
    cast(udf_c26 as varchar(500)) as udf_c26,
    cast(udf_c27 as varchar(500)) as udf_c27,
    cast(udf_c28 as varchar(500)) as udf_c28,
    cast(udf_c29 as varchar(500)) as udf_c29,
    cast(udf_c30 as varchar(500)) as udf_c30,
    cast(udf_c31 as varchar(500)) as udf_c31,
    cast(udf_c32 as varchar(500)) as udf_c32,
    cast(udf_c33 as varchar(500)) as udf_c33,
    cast(udf_c34 as varchar(500)) as udf_c34,
    cast(udf_c35 as varchar(500)) as udf_c35,
    cast(udf_c36 as varchar(500)) as udf_c36,
    cast(udf_c37 as varchar(500)) as udf_c37,
    cast(udf_c38 as varchar(500)) as udf_c38,
    cast(udf_c39 as varchar(500)) as udf_c39,
    cast(udf_c40 as varchar(500)) as udf_c40,
    cast(udf_n01 as decimal(38, 0)) as udf_n01,
    cast(udf_n02 as decimal(38, 0)) as udf_n02,
    cast(udf_n03 as decimal(38, 0)) as udf_n03,
    cast(udf_n04 as decimal(38, 0)) as udf_n04,
    cast(udf_n05 as decimal(38, 0)) as udf_n05,
    cast(udf_n06 as decimal(38, 0)) as udf_n06,
    cast(udf_n07 as float) as udf_n07,
    cast(udf_n08 as float) as udf_n08,
    cast(udf_n09 as float) as udf_n09,
    cast(udf_n10 as float) as udf_n10,
    cast(udf_d01 as date) as udf_d01,
    cast(udf_d02 as date) as udf_d02,
    cast(udf_d03 as date) as udf_d03,
    cast(udf_d04 as date) as udf_d04,
    cast(udf_d05 as date) as udf_d05,
    cast(udf_c41 as varchar(500)) as udf_c41,
    cast(udf_c42 as varchar(500)) as udf_c42,
    cast(udf_c43 as varchar(500)) as udf_c43,
    cast(udf_c44 as varchar(500)) as udf_c44,
    cast(udf_c45 as varchar(500)) as udf_c45,
    cast(udf_c46 as varchar(500)) as udf_c46,
    cast(udf_c47 as varchar(500)) as udf_c47,
    cast(udf_c48 as varchar(500)) as udf_c48,
    cast(udf_c49 as varchar(500)) as udf_c49,
    cast(udf_c50 as varchar(500)) as udf_c50,
    cast(udf_c51 as varchar(500)) as udf_c51,
    cast(udf_c52 as varchar(500)) as udf_c52,
    cast(udf_c53 as varchar(500)) as udf_c53,
    cast(udf_c54 as varchar(500)) as udf_c54,
    cast(udf_c55 as varchar(500)) as udf_c55,
    cast(udf_c56 as varchar(500)) as udf_c56,
    cast(udf_c57 as varchar(500)) as udf_c57,
    cast(udf_c58 as varchar(500)) as udf_c58,
    cast(udf_c59 as varchar(500)) as udf_c59,
    cast(udf_c60 as varchar(500)) as udf_c60,
    cast(udf_c61 as varchar(500)) as udf_c61,
    cast(udf_c62 as varchar(500)) as udf_c62,
    cast(udf_c63 as varchar(500)) as udf_c63,
    cast(udf_c64 as varchar(500)) as udf_c64,
    cast(udf_c65 as varchar(500)) as udf_c65,
    cast(udf_c66 as varchar(500)) as udf_c66,
    cast(udf_c67 as varchar(500)) as udf_c67,
    cast(udf_c68 as varchar(500)) as udf_c68,
    cast(udf_c69 as varchar(500)) as udf_c69,
    cast(udf_c70 as varchar(500)) as udf_c70,
    cast(udf_c71 as varchar(500)) as udf_c71,
    cast(udf_c72 as varchar(500)) as udf_c72,
    cast(udf_c73 as varchar(500)) as udf_c73,
    cast(udf_c74 as varchar(500)) as udf_c74,
    cast(udf_c75 as varchar(500)) as udf_c75,
    cast(udf_c76 as varchar(500)) as udf_c76,
    cast(udf_c77 as varchar(500)) as udf_c77,
    cast(udf_c78 as varchar(500)) as udf_c78,
    cast(udf_c79 as varchar(500)) as udf_c79,
    cast(udf_c80 as varchar(500)) as udf_c80,
    cast(udf_c81 as varchar(500)) as udf_c81,
    cast(udf_c82 as varchar(500)) as udf_c82,
    cast(udf_c83 as varchar(500)) as udf_c83,
    cast(udf_c84 as varchar(500)) as udf_c84,
    cast(udf_c85 as varchar(500)) as udf_c85,
    cast(udf_c86 as varchar(500)) as udf_c86,
    cast(udf_c87 as varchar(500)) as udf_c87,
    cast(udf_c88 as varchar(500)) as udf_c88,
    cast(udf_c89 as varchar(500)) as udf_c89,
    cast(udf_c90 as varchar(500)) as udf_c90,
    cast(udf_c91 as varchar(500)) as udf_c91,
    cast(udf_c92 as varchar(500)) as udf_c92,
    cast(udf_c93 as varchar(500)) as udf_c93,
    cast(udf_c94 as varchar(500)) as udf_c94,
    cast(udf_c95 as varchar(500)) as udf_c95,
    cast(udf_c96 as varchar(500)) as udf_c96,
    cast(udf_c97 as varchar(500)) as udf_c97,
    cast(udf_c98 as varchar(500)) as udf_c98,
    cast(udf_c99 as varchar(500)) as udf_c99,
    cast(udf_c100 as varchar(500)) as udf_c100,
    cast(udf_c101 as varchar(500)) as udf_c101,
    cast(udf_c102 as varchar(500)) as udf_c102,
    cast(udf_c103 as varchar(500)) as udf_c103,
    cast(udf_c104 as varchar(500)) as udf_c104,
    cast(udf_c105 as varchar(500)) as udf_c105,
    cast(udf_c106 as varchar(500)) as udf_c106,
    cast(udf_c107 as varchar(500)) as udf_c107,
    cast(udf_c108 as varchar(500)) as udf_c108,
    cast(udf_c109 as varchar(500)) as udf_c109,
    cast(udf_c110 as varchar(500)) as udf_c110,
    cast(udf_c111 as varchar(500)) as udf_c111,
    cast(udf_c112 as varchar(500)) as udf_c112,
    cast(udf_c113 as varchar(500)) as udf_c113,
    cast(udf_c114 as varchar(500)) as udf_c114,
    cast(udf_c115 as varchar(500)) as udf_c115,
    cast(udf_c116 as varchar(500)) as udf_c116,
    cast(udf_c117 as varchar(500)) as udf_c117,
    cast(udf_c118 as varchar(500)) as udf_c118,
    cast(udf_c119 as varchar(500)) as udf_c119,
    cast(udf_c120 as varchar(500)) as udf_c120,
    cast(udf_c121 as varchar(500)) as udf_c121,
    cast(udf_c122 as varchar(500)) as udf_c122,
    cast(udf_c123 as varchar(500)) as udf_c123,
    cast(udf_c124 as varchar(500)) as udf_c124,
    cast(udf_c125 as varchar(500)) as udf_c125,
    cast(udf_c126 as varchar(500)) as udf_c126,
    cast(udf_c127 as varchar(500)) as udf_c127,
    cast(udf_c128 as varchar(500)) as udf_c128,
    cast(udf_c129 as varchar(500)) as udf_c129,
    cast(udf_c130 as varchar(500)) as udf_c130,
    cast(udf_c131 as varchar(500)) as udf_c131,
    cast(udf_c132 as varchar(500)) as udf_c132,
    cast(udf_c133 as varchar(500)) as udf_c133,
    cast(udf_c134 as varchar(500)) as udf_c134,
    cast(udf_c135 as varchar(500)) as udf_c135,
    cast(udf_c136 as varchar(500)) as udf_c136,
    cast(udf_c137 as varchar(500)) as udf_c137,
    cast(udf_c138 as varchar(500)) as udf_c138,
    cast(udf_c139 as varchar(500)) as udf_c139,
    cast(udf_c140 as varchar(500)) as udf_c140,
    cast(install_index1_id as decimal(38, 0)) as install_index1_id,
    cast(install_index2_id as decimal(38, 0)) as install_index2_id,
    cast(install_index3_id as decimal(38, 0)) as install_index3_id,
    cast(install_index4_id as decimal(38, 0)) as install_index4_id,
    cast(install_index5_id as decimal(38, 0)) as install_index5_id,
    cast(eng_proj_id as decimal(38, 0)) as eng_proj_id,
    cast(eng_ref_id as decimal(38, 0)) as eng_ref_id,
    'VGCP2' as project_code,
    cast(execution_date as date) as extracted_date,
	source_system_name,
    {{run_date}} as model_created_date,
    {{run_date}} as model_updated_date,
    {{ generate_load_id(model) }} as model_load_id
from
    {{ source('curated_spi', 'curated_udf_component') }}