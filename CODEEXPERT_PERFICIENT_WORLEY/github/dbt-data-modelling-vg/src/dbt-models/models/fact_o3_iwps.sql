{{ config(materialized='table') }}

select 
    cast(primary_key as varchar) as iwpspk,
    cast(id as int) as entityid,
    cast(entitytypeid as int),
    cast(constructionworkareaid as int),
    cast(constructiontypeid as int),
    cast(disciplineid as int),
    cast(cwp as varchar) as cwpsid,
    cast(name as varchar) as iwpsid,
    cast(description as varchar) as iwpsdescription,
    cast(longdescription as varchar) as iwpslongdescription,
    cast(projectid as int),
    cast(projectcode as varchar),
    cast(projectinfo as varchar),
    cast(statusid as int),
    cast(status as varchar),
    cast(statusdate as varchar),
    cast(iwpstatuscolor as varchar),
    cast(significantrequirements as varchar),
    cast(scopeexclusions as varchar),
    cast(externallink as varchar),
    cast(workpackagetypeid as varchar),
    cast(workpackagetype as varchar),
    cast(revision as varchar),
    cast(constructionworkpackageid as int),
    cast(unitid as int),
    cast(unit as varchar),
    cast(deliveryteamid as varchar),
    cast(deliveryteam as varchar),
    cast(zoneid as int),
    cast(zone as varchar),
    cast(areaid as int),
    cast(area as varchar),
    cast(areacode as varchar),
    cast(purposeid as int),
    cast(purpose as varchar),
    cast(purposecategoryid as varchar),
    cast(purposecategory as varchar),
    cast(contractid as int),
    cast(contract as varchar),
    cast(planneruserid as int),
    cast(planneruser as varchar),
    cast(planneruseremail as varchar),
    cast(plannerusercompany as varchar),
    cast(drawingcount as int),
    cast(budgetedhours as float),
    cast(estimatedhours as float),
    cast(iwpsequencenumber as int),
    cast(scheduleactivityid as varchar),
    cast(taskcode as varchar),
    cast(plannedissuedate as timestamp),
    cast(actualissuedate as timestamp),
    cast(issuedatevariance as float),
    cast(plannedstartdate as timestamp),
    cast(plannedstartyear as varchar),
    cast(plannedstartmonth as varchar),
    cast(plannedstartweekofyear as varchar),
    cast(plannedstartdayofyear as varchar),
    cast(plannedstartweek as varchar),
    cast(actualstartdate as timestamp),
    cast(actualstartyear as varchar),
    cast(actualstartmonth as varchar),
    cast(actualstartweekofyear as varchar),
    cast(actualstartdayofyear as varchar),
    cast(startdatevariance as float),
    cast(plannedfinishdate as timestamp),
    cast(plannedfinishweek as varchar),
    cast(actualfinishdate as timestamp),
    cast(actualfinishyear as varchar),
    cast(actualfinishmonth as varchar),
    cast(actualfinishweekofyear as varchar),
    cast(actualfinishdayofyear as varchar),
    cast(finishdatevariance as float),
    cast(assemblystartdate as timestamp),
    cast(assemblystartweek as varchar),
    cast(assemblyfinishdate as timestamp),
    cast(releasedtouserid as varchar),
    cast(releasedtouser as varchar),
    cast(datereleased as timestamp),
    cast(datedelivered as timestamp),
    cast(earnedhours as float),
    cast(actualhours as float),
    cast(forecastedhours as float),
    cast(productivityfactor as varchar),
    cast(percentcomplete as float),
    cast(percentdocumented as float),
    cast(percentdocumentedinclusive as float),
    cast(openconstraintcount as int),
    cast(overdueconstraintcount as int),
    cast(totalconstraintcount as int),
    cast(closedconstraintcount as int),
    cast(percentconstraintfree as float),
    cast(percentdelayfree as varchar),
    cast(percentapproved as float),
    cast(percentdeveloped as float),
    cast(subcwp as varchar),
    cast(iwpfilename as varchar),
    cast(iwpstatus as varchar),
    cast(keyquantity as float),
    cast(unitofmeasureid as int),
    cast(uom as varchar),
    cast(draftreviewdate as timestamp),
    cast(plannedreadyforreviewdate as timestamp),
    cast(readyforreviewdate as timestamp),
    cast(plannedapproveddate as timestamp),
    cast(approveddate as timestamp),
    cast(preparedfor as varchar),
    cast(plannedduration as varchar),
    cast(actualduration as varchar),
    cast(wbsid as int),
    cast(wbs as varchar),
    cast(wbsdescription as varchar),
    cast(sourceid as varchar),
    cast(source as varchar),
    cast(sourceimportid as varchar),
    cast(sourcedatecreated as timestamp),
    cast(sourcedeleted as boolean),
    cast(datecreated as timestamp),
    cast(createdbyuserid as int),
    cast(createdbyuser as varchar),
    cast(datemodified as timestamp),
    cast(modifiedbyuserid as int),
    cast(modifiedbyuser as varchar),
    cast(isdeleted as boolean),
    cast(dateconstraintfree as timestamp),
    cast(datefirstconstraintcompleted as timestamp),
    cast(datefirstconstraintcreated as timestamp),
    cast(datelastconstraintcreated as timestamp),
    cast(datedatacomplete as timestamp),
    cast(datecloseoutdatacomplete as timestamp),
    cast(planneddevelopmentstartdate as timestamp),
    cast(actualdevelopmentstartdate as timestamp),
    cast(lastpackagedcomponentdate as timestamp),
    cast(constraintrollupstatusid as int),
    cast(constraintrollupstatus as varchar),
    cast(constraintrollupstatuscolor as varchar),
    cast(datacompletenessstatus as varchar),
    cast(calendarstartdate as timestamp),
    cast(calendarenddate as timestamp),
    cast(crewsize as int),
    cast(workconditionid as varchar),
    cast(workcondition as varchar),
    cast(revisiondate as timestamp),
    cast(tradecoordinationnotes as varchar),
    cast(plantoperationsnotes as varchar),
    cast(specialtycontractornotes as varchar),
    cast(qualitynotes as varchar),
    cast(toolnotes as varchar),
    cast(constructionequipmentnotes as varchar),
    cast(overviewmodelshotattachmentid as varchar),
    cast(actualcloseoutdate as timestamp),
    cast(plannedcloseoutdate as timestamp),
    cast(contractgroupid as int),
    cast(contractgroup as varchar),
    cast(criticalpath as boolean),
    cast(criticalpathcategoryid as varchar),
    cast(criticalpathcategory as varchar),
    cast(statuscolor as varchar),
    cast(safetynotes as varchar),
    cast(dateapprovedforconstruction as varchar),
    cast(fccnotes as varchar),
    cast(lessonslearnednotes as varchar),
    cast(interfacesnotes as varchar),
    cast(specialnotes as varchar),
    cast(turnoversystemid as varchar),
    cast(turnoversystem as varchar),
    cast(turnoversubsystemid as varchar),
    cast(turnoversubsystem as varchar),
    cast(baselinestartdate as timestamp),
    cast(baselinefinishdate as timestamp),
    cast(attachmentcount as int),
    cast(foremanuserid as varchar),
    cast(foreman as varchar),
    cast(foreman2userid as varchar),
    cast(foreman2 as varchar),
    cast(foreman3userid as varchar),
    cast(foreman3 as varchar),
    cast(alternateforemanuserid as varchar),
    cast(alternateforeman as varchar),
    cast(generalforemanuserid as varchar),
    cast(generalforeman as varchar),
    cast(generalforemanemail as varchar),
    cast(generalforeman2userid as varchar),
    cast(generalforeman2 as varchar),
    cast(generalforeman2email as varchar),
    cast(generalforeman3userid as varchar),
    cast(generalforeman3 as varchar),
    cast(generalforeman3email as varchar),
    cast(superintendentuserid as varchar),
    cast(superintendent as varchar),
    cast(superintendentemail as varchar),
    cast(superintendent2userid as varchar),
    cast(superintendent2 as varchar),
    cast(superintendent2email as varchar),
    cast(superintendent3userid as varchar),
    cast(superintendent3 as varchar),
    cast(superintendent3email as varchar),
    cast(testsystemid as varchar),
    cast(testsystem as varchar),
    cast(testsubsystemid as varchar),
    cast(testsubsystem as varchar),
    cast(permitissuerid as varchar),
    cast(permitissuer as varchar),
    cast(latestartrootcauseid as varchar),
    cast(latestartrootcause as varchar),
    cast(latefinishrootcauseid as varchar),
    cast(latefinishrootcause as varchar),
    cast(companysupervisorid as varchar),
    cast(companysupervisor as varchar),
    cast(contractorsupervisorid as varchar),
    cast(contractorsupervisor as varchar),
    cast(unitcategoryid as varchar),
    cast(unitcategory as varchar),
    cast(labels as varchar),
    cast(stateid as varchar),
    cast(forecaststartdate as varchar),
    cast(forecastfinishdate as varchar),
    cast(externallinkverified as boolean),
    cast(externallinkverifiedbyuser as varchar),
    cast(externallinkverifiedbyuserid as varchar),
    cast(externallinkverifieddate as timestamp),
    cast(plannedapprovedforconstructiondate as timestamp),
    cast(forgemodelshotstate as varchar),
    cast(invalidmodeldata as boolean),
    cast(operationsrequirements as varchar),
    cast(projectphaseid as int),
    cast(projectphase as varchar),
    cast(criticalpath2 as boolean),
    cast(systemrequired as boolean),
    cast(plannedreleasedtoqualitydate as timestamp),
    cast(actualreleasedtoqualitydate as timestamp),
    cast(rigginglocationid as varchar),
    cast(rigginglocation as varchar),
    cast(tasksneedingcalculationcount as int),
    cast(modelshot as boolean),
    cast(forecastduration as varchar),
    cast(cwpstatusid as int),
    cast(cwpstatus as varchar),
    cast(cwpstatuscolor as varchar),
    cast(insulationtypeid as varchar),
    cast(insulationtype as varchar),
    cast(painttypeid as varchar),
    cast(painttype as varchar),
    cast(hydrotesttypeid as varchar),
    cast(hydrotesttype as varchar),
    cast(estimatedcost as float),
    cast(forecastcost as float),
    cast(actualcost as float),
    cast(scheduleactivitylookupid as varchar),
    cast(scheduleactivity as varchar),
    cast(plotplancount as int),
    cast(crewid as varchar),
    cast(crew as varchar),
    cast(scaffoldingrequired as boolean),
    cast(remaininghours as float),
    cast(scheduledatadate as timestamp),
    cast(earlystartdate as timestamp),
    cast(latestartdate as timestamp),
    cast(earlyfinishdate as timestamp),
    cast(latefinishdate as timestamp),
    cast(workingdayduration as float),
    cast(developedhours as float),
    cast(functionalareaid as varchar),
    cast(functionalarea as varchar),
    cast(is_current as int),
    cast(eff_start_date as timestamp),
    cast(eff_end_date as timestamp)
from 
    {{ source('curated_vg_o3', 'curated_iwps') }}
where is_current = 1
--ALTER TABLE fact_o3_iwps ADD CONSTRAINT iwps_pk PRIMARY KEY (iwpspk);
