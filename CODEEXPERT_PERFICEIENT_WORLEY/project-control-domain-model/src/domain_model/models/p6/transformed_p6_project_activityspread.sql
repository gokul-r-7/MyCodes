{%- set execution_date_arg = var("execution_date", "") %}
{%- set run_date = "CURRENT_DATE" -%}
{{
    config(
        materialized='incremental',
        incremental_strategy='insert_overwrite',
        file_format='iceberg',
        iceberg_expire_snapshots='False',
        custom_location=target.location ~ 'oracle_p6/transformed_p6_project_activityspread/',
        table_properties={'write.target-file-size-bytes': '268435456'},
        on_schema_change='append_new_columns',
        full_refresh=true,
        tags=["p6", "v2"]
        )
}}

SELECT 
activityid as activity_key,
activityid as activity_val_id,
activityobjectid as activityobjectid,
activityowneruserid as activityowneruserid,
actuallaborunits as actuallaborunits,
cbscode as cbscode,
cbsid as cbsid,
enddate as enddate,
externalearlystartdate as externalearlystartdate,
externallatefinishdate as externallatefinishdate,
feedback as feedback,
floatpath as floatpath,
floatpathorder as floatpathorder,
hasfuturebucketdata as hasfuturebucketdata,
locationname as locationname,
locationobjectid as locationobjectid,
maximumduration as maximumduration,
minimumduration as minimumduration,
mostlikelyduration as mostlikelyduration,
notestoresources as notestoresources,
owneridarray as owneridarray,
ownernamesarray as ownernamesarray,
period_actualcost as period_actualcost,
period_actualexpensecost as period_actualexpensecost,
period_actuallaborcost as period_actuallaborcost,
period_actuallaborunits as period_actuallaborunits,
period_actualmaterialcost as period_actualmaterialcost,
period_actualnonlaborcost as period_actualnonlaborcost,
period_actualnonlaborunits as period_actualnonlaborunits,
period_actualtotalcost as period_actualtotalcost,
period_atcompletionexpensecost as period_atcompletionexpensecost,
period_atcompletionlaborcost as period_atcompletionlaborcost,
period_atcompletionlaborunits as period_atcompletionlaborunits,
period_atcompletionmaterialcost as period_atcompletionmaterialcost,
period_atcompletionnonlaborcost as period_atcompletionnonlaborcost,
period_atcompletionnonlaborunits as period_atcompletionnonlaborunits,
period_atcompletiontotalcost as period_atcompletiontotalcost,
period_baseline1actualexpensecost as period_baseline1actualexpensecost,
period_baseline1actuallaborcost as period_baseline1actuallaborcost,
period_baseline1actuallaborunits as period_baseline1actuallaborunits,
period_baseline1actualmaterialcost as period_baseline1actualmaterialcost,
period_baseline1actualnonlaborcost as period_baseline1actualnonlaborcost,
period_baseline1actualnonlaborunits as period_baseline1actualnonlaborunits,
period_baseline1actualtotalcost as period_baseline1actualtotalcost,
period_baseline1plannedexpensecost as period_baseline1plannedexpensecost,
period_baseline1plannedlaborcost as period_baseline1plannedlaborcost,
period_baseline1plannedlaborunits as period_baseline1plannedlaborunits,
period_baseline1plannedmaterialcost as period_baseline1plannedmaterialcost,
period_baseline1plannednonlaborcost as period_baseline1plannednonlaborcost,
period_baseline1plannednonlaborunits as period_baseline1plannednonlaborunits,
period_baseline1plannedtotalcost as period_baseline1plannedtotalcost,
period_baselineactualexpensecost as period_baselineactualexpensecost,
period_baselineactuallaborcost as period_baselineactuallaborcost,
period_baselineactuallaborunits as period_baselineactuallaborunits,
period_baselineactualmaterialcost as period_baselineactualmaterialcost,
period_baselineactualnonlaborcost as period_baselineactualnonlaborcost,
period_baselineactualnonlaborunits as period_baselineactualnonlaborunits,
period_baselineactualtotalcost as period_baselineactualtotalcost,
period_baselineplannedexpensecost as period_baselineplannedexpensecost,
period_baselineplannedlaborcost as period_baselineplannedlaborcost,
period_baselineplannedlaborunits as period_baselineplannedlaborunits,
period_baselineplannedmaterialcost as period_baselineplannedmaterialcost,
period_baselineplannednonlaborcost as period_baselineplannednonlaborcost,
period_baselineplannednonlaborunits as period_baselineplannednonlaborunits,
period_baselineplannedtotalcost as period_baselineplannedtotalcost,
period_cumulativeactualcost as period_cumulativeactualcost,
period_cumulativeactualexpensecost as period_cumulativeactualexpensecost,
period_cumulativeactuallaborcost as period_cumulativeactuallaborcost,
period_cumulativeactuallaborunits as period_cumulativeactuallaborunits,
period_cumulativeactualmaterialcost as period_cumulativeactualmaterialcost,
period_cumulativeactualnonlaborcost as period_cumulativeactualnonlaborcost,
period_cumulativeactualnonlaborunits as period_cumulativeactualnonlaborunits,
period_cumulativeactualtotalcost as period_cumulativeactualtotalcost,
period_cumulativeatcompletionexpensecost as period_cumulativeatcompletionexpensecost,
period_cumulativeatcompletionlaborcost as period_cumulativeatcompletionlaborcost,
period_cumulativeatcompletionlaborunits as period_cumulativeatcompletionlaborunits,
period_cumulativeatcompletionmaterialcost as period_cumulativeatcompletionmaterialcost,
period_cumulativeatcompletionnonlaborcost as period_cumulativeatcompletionnonlaborcost,
period_cumulativeatcompletionnonlaborunits as period_cumulativeatcompletionnonlaborunits,
period_cumulativeatcompletiontotalcost as period_cumulativeatcompletiontotalcost,
period_cumulativebaseline1actualexpensecost as period_cumulativebaseline1actualexpensecost,
period_cumulativebaseline1actuallaborcost as period_cumulativebaseline1actuallaborcost,
period_cumulativebaseline1actuallaborunits as period_cumulativebaseline1actuallaborunits,
period_cumulativebaseline1actualmaterialcost as period_cumulativebaseline1actualmaterialcost,
period_cumulativebaseline1actualnonlaborcost as period_cumulativebaseline1actualnonlaborcost,
period_cumulativebaseline1actualnonlaborunits as period_cumulativebaseline1actualnonlaborunits,
period_cumulativebaseline1actualtotalcost as period_cumulativebaseline1actualtotalcost,
period_cumulativebaseline1plannedexpensecost as period_cumulativebaseline1plannedexpensecost,
period_cumulativebaseline1plannedlaborcost as period_cumulativebaseline1plannedlaborcost,
period_cumulativebaseline1plannedlaborunits as period_cumulativebaseline1plannedlaborunits,
period_cumulativebaseline1plannedmaterialcost as period_cumulativebaseline1plannedmaterialcost,
period_cumulativebaseline1plannednonlaborcost as period_cumulativebaseline1plannednonlaborcost,
period_cumulativebaseline1plannednonlaborunits as period_cumulativebaseline1plannednonlaborunits,
period_cumulativebaseline1plannedtotalcost as period_cumulativebaseline1plannedtotalcost,
period_cumulativebaselineactualexpensecost as period_cumulativebaselineactualexpensecost,
period_cumulativebaselineactuallaborcost as period_cumulativebaselineactuallaborcost,
period_cumulativebaselineactuallaborunits as period_cumulativebaselineactuallaborunits,
period_cumulativebaselineactualmaterialcost as period_cumulativebaselineactualmaterialcost,
period_cumulativebaselineactualnonlaborcost as period_cumulativebaselineactualnonlaborcost,
period_cumulativebaselineactualnonlaborunits as period_cumulativebaselineactualnonlaborunits,
period_cumulativebaselineactualtotalcost as period_cumulativebaselineactualtotalcost,
period_cumulativebaselineplannedexpensecost as period_cumulativebaselineplannedexpensecost,
period_cumulativebaselineplannedlaborcost as period_cumulativebaselineplannedlaborcost,
period_cumulativebaselineplannedlaborunits as period_cumulativebaselineplannedlaborunits,
period_cumulativebaselineplannedmaterialcost as period_cumulativebaselineplannedmaterialcost,
period_cumulativebaselineplannednonlaborcost as period_cumulativebaselineplannednonlaborcost,
period_cumulativebaselineplannednonlaborunits as period_cumulativebaselineplannednonlaborunits,
period_cumulativebaselineplannedtotalcost as period_cumulativebaselineplannedtotalcost,
period_cumulativeearnedvaluecost as period_cumulativeearnedvaluecost,
period_cumulativeearnedvaluelaborunits as period_cumulativeearnedvaluelaborunits,
period_cumulativeestimateatcompletioncost as period_cumulativeestimateatcompletioncost,
period_cumulativeestimateatcompletionlaborunits as period_cumulativeestimateatcompletionlaborunits,
period_cumulativeestimatetocompletecost as period_cumulativeestimatetocompletecost,
period_cumulativeestimatetocompletelaborunits as period_cumulativeestimatetocompletelaborunits,
period_cumulativeplannedexpensecost as period_cumulativeplannedexpensecost,
period_cumulativeplannedlaborcost as period_cumulativeplannedlaborcost,
period_cumulativeplannedlaborunits as period_cumulativeplannedlaborunits,
period_cumulativeplannedmaterialcost as period_cumulativeplannedmaterialcost,
period_cumulativeplannednonlaborcost as period_cumulativeplannednonlaborcost,
period_cumulativeplannednonlaborunits as period_cumulativeplannednonlaborunits,
period_cumulativeplannedtotalcost as period_cumulativeplannedtotalcost,
period_cumulativeplannedvaluecost as period_cumulativeplannedvaluecost,
period_cumulativeplannedvaluelaborunits as period_cumulativeplannedvaluelaborunits,
period_cumulativeremainingexpensecost as period_cumulativeremainingexpensecost,
period_cumulativeremaininglaborcost as period_cumulativeremaininglaborcost,
period_cumulativeremaininglaborunits as period_cumulativeremaininglaborunits,
period_cumulativeremaininglateexpensecost as period_cumulativeremaininglateexpensecost,
period_cumulativeremaininglatelaborcost as period_cumulativeremaininglatelaborcost,
period_cumulativeremaininglatelaborunits as period_cumulativeremaininglatelaborunits,
period_cumulativeremaininglatematerialcost as period_cumulativeremaininglatematerialcost,
period_cumulativeremaininglatenonlaborcost as period_cumulativeremaininglatenonlaborcost,
period_cumulativeremaininglatenonlaborunits as period_cumulativeremaininglatenonlaborunits,
period_cumulativeremaininglatetotalcost as period_cumulativeremaininglatetotalcost,
period_cumulativeremainingmaterialcost as period_cumulativeremainingmaterialcost,
period_cumulativeremainingnonlaborcost as period_cumulativeremainingnonlaborcost,
period_cumulativeremainingnonlaborunits as period_cumulativeremainingnonlaborunits,
period_cumulativeremainingtotalcost as period_cumulativeremainingtotalcost,
period_earnedvaluecost as period_earnedvaluecost,
period_earnedvaluelaborunits as period_earnedvaluelaborunits,
period_enddate as period_enddate,
period_estimateatcompletioncost as period_estimateatcompletioncost,
period_estimateatcompletionlaborunits as period_estimateatcompletionlaborunits,
period_estimatetocompletecost as period_estimatetocompletecost,
period_estimatetocompletelaborunits as period_estimatetocompletelaborunits,
period_plannedexpensecost as period_plannedexpensecost,
period_plannedlaborcost as period_plannedlaborcost,
period_plannedlaborunits as period_plannedlaborunits,
period_plannedmaterialcost as period_plannedmaterialcost,
period_plannednonlaborcost as period_plannednonlaborcost,
period_plannednonlaborunits as period_plannednonlaborunits,
period_plannedtotalcost as period_plannedtotalcost,
period_plannedvaluecost as period_plannedvaluecost,
period_plannedvaluelaborunits as period_plannedvaluelaborunits,
period_remainingexpensecost as period_remainingexpensecost,
period_remaininglaborcost as period_remaininglaborcost,
period_remaininglaborunits as period_remaininglaborunits,
period_remaininglateexpensecost as period_remaininglateexpensecost,
period_remaininglatelaborcost as period_remaininglatelaborcost,
period_remaininglatelaborunits as period_remaininglatelaborunits,
period_remaininglatematerialcost as period_remaininglatematerialcost,
period_remaininglatenonlaborcost as period_remaininglatenonlaborcost,
period_remaininglatenonlaborunits as period_remaininglatenonlaborunits,
period_remaininglatetotalcost as period_remaininglatetotalcost,
period_remainingmaterialcost as period_remainingmaterialcost,
period_remainingnonlaborcost as period_remainingnonlaborcost,
period_remainingnonlaborunits as period_remainingnonlaborunits,
period_remainingtotalcost as period_remainingtotalcost,
period_startdate as period_startdate,
periodtype as periodtype,
postrespcriticalityindex as postrespcriticalityindex,
postresponsepessimisticfinish as postresponsepessimisticfinish,
postresponsepessimisticstart as postresponsepessimisticstart,
prerespcriticalityindex as prerespcriticalityindex,
preresponsepessimisticfinish as preresponsepessimisticfinish,
preresponsepessimisticstart as preresponsepessimisticstart,
primaryconstraintdate as primaryconstraintdate,
project_id as project_id,
projectid as projectid,
resumedate as resumedate,
reviewfinishdate as reviewfinishdate,
secondaryconstraintdate as secondaryconstraintdate,
source_system_name as source_system_name,
startdate as startdate,
suspenddate as suspenddate,
taskstatusindicator as taskstatusindicator,
workpackageid as workpackageid,
cast(null as string) as workpackagename,
cast(execution_date as date),
{{run_date}} as created_date,
{{run_date}} as updated_date,
{{ generate_load_id(model) }} as load_id
FROM {{ source('curated_p6', 'curated_project_activityspread') }}
