{{ config(materialized='table') }}

select
    --primary_key as activitypk,
    cast(activity_val_id as varchar) as activityid,
    cast(objectid as int),
    cast(name as varchar) as activityname,
    cast(wbscode as varchar),
    cast(wbsname as varchar),
    cast(wbsnamepath as varchar),
    cast(wbsobjectid as varchar),
    cast(wbspath as varchar),
    cast(status as varchar),
    cast(statuscode as varchar),
    cast(projectflag as char),
    cast(project_id as varchar) as projectid,
    cast(projectname as varchar),
    cast(projectnamesepchar as varchar),
    cast(projectobjectid as varchar),
    cast(projectprojectflag as varchar),
    cast(accountingvariance as varchar),
    cast(accountingvariancelaborunits as float),
    cast(activityowneruserid as varchar),
    cast(actualduration as float),
    cast(actualexpensecost as float),
    cast(actualfinishdate as timestamp),
    cast(actuallaborcost as float),
    cast(actuallaborunits as float),
    cast(actualmaterialcost as float),
    cast(actualnonlaborcost as float),
    cast(actualnonlaborunits as float),
    cast(actualstartdate as timestamp),
    cast(actualthisperiodlaborcost as float),
    cast(actualthisperiodlaborunits as float),
    cast(actualthisperiodmaterialcost as float),
    cast(actualthisperiodnonlaborcost as float),
    cast(actualthisperiodnonlaborunits as float),
    cast(actualtotalcost as float),
    cast(actualtotalunits as float),
    cast(atcompletionduration as float),
    cast(atcompletionexpensecost as float),
    cast(atcompletionlaborcost as float),
    cast(atcompletionlaborunits as float),
    cast(atcompletionlaborunitsvariance as float),
    cast(atcompletionmaterialcost as float),
    cast(atcompletionnonlaborcost as float),
    cast(atcompletionnonlaborunits as float),
    cast(atcompletiontotalcost as float),
    cast(atcompletiontotalunits as float),
    cast(atcompletionvariance as float),
    cast(autocomputeactuals as float),
    cast(baseline1duration as varchar),
    cast(baseline1finishdate as timestamp),
    cast(baseline1plannedduration as float),
    cast(baseline1plannedexpensecost as float),
    cast(baseline1plannedlaborcost as float),
    cast(baseline1plannedlaborunits as float),
    cast(baseline1plannedmaterialcost as float),
    cast(baseline1plannednonlaborcost as float),
    cast(baseline1plannednonlaborunits as float),
    cast(baseline1plannedtotalcost as float),
    cast(baseline1startdate as timestamp),
    cast(baseline2duration as float),
    cast(baseline2finishdate as timestamp),
    cast(baseline2plannedduration as float),
    cast(baseline2plannedexpensecost as float),
    cast(baseline2plannedlaborcost as float),
    cast(baseline2plannedlaborunits as float),
    cast(baseline2plannedmaterialcost as float),
    cast(baseline2plannednonlaborcost as float),
    cast(baseline2plannednonlaborunits as float),
    cast(baseline2plannedtotalcost as float),
    cast(baseline2startdate as timestamp),
    cast(baseline3duration as float),
    cast(baseline3finishdate as timestamp),
    cast(baseline3plannedduration as float),
    cast(baseline3plannedexpensecost as float),
    cast(baseline3plannedlaborcost as float),
    cast(baseline3plannedlaborunits as float),
    cast(baseline3plannedmaterialcost as float),
    cast(baseline3plannednonlaborcost as float),
    cast(baseline3plannednonlaborunits as float),
    cast(baseline3plannedtotalcost as float),
    cast(baseline3startdate as timestamp),
    cast(baselineduration as float),
    cast(baselinefinishdate as timestamp),
    cast(baselineplannedduration as float),
    cast(baselineplannedexpensecost as float),
    cast(baselineplannedlaborcost as float),
    cast(baselineplannedlaborunits as float),
    cast(baselineplannedmaterialcost as float),
    cast(baselineplannednonlaborcost as float),
    cast(baselineplannednonlaborunits as float),
    cast(baselineplannedtotalcost as float),
    cast(baselinestartdate as timestamp),
    cast(budgetatcompletion as float),
    cast(cbscode as varchar),
    cast(cbsid as varchar),
    cast(cbsobjectid as varchar),
    cast(calendarname as varchar),
    cast(calendarobjectid as varchar),
    cast(costpercentcomplete as float),
    cast(costpercentofplanned as float),
    cast(costperformanceindex as float),
    cast(costperformanceindexlaborunits as float),
    cast(costvariance as float),
    cast(costvarianceindex as float),
    cast(costvarianceindexlaborunits as float),
    cast(costvariancelaborunits as float),
    cast(createdate as timestamp),
    cast(createuser as varchar),
    cast(datadate as timestamp),
    cast(duration1variance as float),
    cast(duration2variance as float),
    cast(duration3variance as float),
    cast(durationpercentcomplete as float),
    cast(durationpercentofplanned as float),
    cast(durationtype as varchar),
    cast(durationvariance as float),
    cast(earlyfinishdate as timestamp),
    cast(earlystartdate as timestamp),
    cast(earnedvaluecost as float),
    cast(earnedvaluelaborunits as float),
    cast(estimateatcompletioncost as float),
    cast(estimateatcompletionlaborunits as float),
    cast(estimatetocomplete as varchar),
    cast(estimatetocompletelaborunits as float),
    cast(estimatedweight as float),
    cast(expectedfinishdate as timestamp),
    cast(expensecost1variance as float),
    cast(expensecost2variance as float),
    cast(expensecost3variance as float),
    cast(expensecostpercentcomplete as float),
    cast(expensecostvariance as float),
    cast(externalearlystartdate as timestamp),
    cast(externallatefinishdate as timestamp),
    cast(feedback as varchar),
    cast(financialperiodtmplid as varchar),
    cast(finishdate as timestamp),
    cast(finishdate1variance as float),
    cast(finishdate2variance as float),
    cast(finishdate3variance as float),
    cast(finishdatevariance as float),
    cast(floatpath as varchar),
    cast(floatpathorder as varchar),
    cast(freefloat as varchar),
    cast(guid as varchar),
    cast(hasfuturebucketdata as varchar),
    cast(isbaseline as varchar),
    cast(iscritical as varchar),
    cast(islongestpath as varchar),
    cast(isnewfeedback as varchar),
    cast(isstarred as varchar),
    cast(istemplate as varchar),
    cast(isworkpackage as varchar),
    cast(laborcost1variance as float),
    cast(laborcost2variance as float),
    cast(laborcost3variance as float),
    cast(laborcostpercentcomplete as float),
    cast(laborcostvariance as float),
    cast(laborunits1variance as float),
    cast(laborunits2variance as float),
    cast(laborunits3variance as float),
    cast(laborunitspercentcomplete as float),
    cast(laborunitsvariance as float),
    cast(lastupdatedate as timestamp),
    cast(lastupdateuser as varchar),
    cast(latefinishdate as timestamp),
    cast(latestartdate as timestamp),
    cast(levelingpriority as varchar),
    cast(locationname as varchar),
    cast(locationobjectid as varchar),
    cast(materialcost1variance as float),
    cast(materialcost2variance as float),
    cast(materialcost3variance as float),
    cast(materialcostpercentcomplete as float),
    cast(materialcostvariance as float),
    cast(maximumduration as varchar),
    cast(minimumduration as varchar),
    cast(mostlikelyduration as varchar),
    cast(nonlaborcost1variance as float),
    cast(nonlaborcost2variance as float),
    cast(nonlaborcost3variance as float),
    cast(nonlaborcostpercentcomplete as float),
    cast(nonlaborcostvariance as float),
    cast(nonlaborunits1variance as float),
    cast(nonlaborunits2variance as float),
    cast(nonlaborunits3variance as float),
    cast(nonlaborunitspercentcomplete as float),
    cast(nonlaborunitsvariance as float),
    cast(notestoresources as varchar),
    cast(owneridarray as varchar),
    cast(ownernamesarray as varchar),
    cast(percentcomplete as float),
    cast(percentcompletetype as varchar),
    cast(performancepercentcomplete as float),
    cast(performancepercentcompletebylaborunits as float),
    cast(physicalpercentcomplete as float),
    cast(plannedduration as float),
    cast(plannedexpensecost as float),
    cast(plannedfinishdate as timestamp),
    cast(plannedlaborcost as float),
    cast(plannedlaborunits as float),
    cast(plannedmaterialcost as float),
    cast(plannednonlaborcost as float),
    cast(plannednonlaborunits as float),
    cast(plannedstartdate as timestamp),
    cast(plannedtotalcost as float),
    cast(plannedtotalunits as float),
    cast(plannedvaluecost as float),
    cast(plannedvaluelaborunits as float),
    cast(postrespcriticalityindex as varchar),
    cast(postresponsepessimisticfinish as timestamp),
    cast(postresponsepessimisticstart as timestamp),
    cast(prerespcriticalityindex as varchar),
    cast(preresponsepessimisticfinish as timestamp),
    cast(preresponsepessimisticstart as timestamp),
    cast(primaryconstraintdate as timestamp),
    cast(primaryconstrainttype as varchar),
    cast(primaryresourceid as varchar),
    cast(primaryresourcename as varchar),
    cast(primaryresourceobjectid as varchar),
    cast(remainingduration as varchar),
    cast(remainingearlyfinishdate as timestamp),
    cast(remainingearlystartdate as timestamp),
    cast(remainingexpensecost as float),
    cast(remainingfloat as float),
    cast(remaininglaborcost as float),
    cast(remaininglaborunits as float),
    cast(remaininglatefinishdate as timestamp),
    cast(remaininglatestartdate as timestamp),
    cast(remainingmaterialcost as float),
    cast(remainingnonlaborcost as float),
    cast(remainingnonlaborunits as float),
    cast(remainingtotalcost as float),
    cast(remainingtotalunits as float),
    cast(resumedate as timestamp),
    cast(reviewfinishdate as timestamp),
    cast(reviewrequired as varchar),
    cast(reviewstatus as varchar),
    cast(schedulepercentcomplete as float),
    cast(scheduleperformanceindex as varchar),
    cast(scheduleperformanceindexlaborunits as varchar),
    cast(schedulevariance as float),
    cast(schedulevarianceindex as varchar),
    cast(schedulevarianceindexlaborunits as float),
    cast(schedulevariancelaborunits as float),
    cast(scopepercentcomplete as float),
    cast(secondaryconstraintdate as timestamp),
    cast(secondaryconstrainttype as varchar),
    cast(startdate as timestamp),
    cast(startdate1variance as float),
    cast(startdate2variance as float),
    cast(startdate3variance as float),
    cast(startdatevariance as float),
    cast(suspenddate as timestamp),
    cast(taskstatuscompletion as varchar),
    cast(taskstatusdates as varchar),
    cast(taskstatusindicator as varchar),
    cast(tocompleteperformanceindex as varchar),
    cast(totalcost1variance as float),
    cast(totalcost2variance as float),
    cast(totalcost3variance as float),
    cast(totalcostvariance as float),
    cast(totalfloat as float),
    cast(totalpastperiodearnedvaluecostbcwp as float),
    cast(totalpastperiodearnedvaluelaborunits as float),
    cast(totalpastperiodexpensecost as float),
    cast(totalpastperiodlaborcost as float),
    cast(totalpastperiodlaborunits as float),
    cast(totalpastperiodmaterialcost as float),
    cast(totalpastperiodnonlaborcost as float),
    cast(totalpastperiodnonlaborunits as float),
    cast(totalpastperiodplannedvaluecost as float),
    cast(totalpastperiodplannedvaluelaborunits as float),
    cast(type as varchar),
    cast(unitspercentcomplete as float),
    cast(unreadcommentcount as float),
    cast(workpackageid as varchar),
    cast(workpackagename as varchar)
--    cast(is_current as float),
    --cast(eff_start_date as timestamp),
    --cast(eff_end_date as timestamp)
from
    {{ source('curated_vg_p6', 'curated_project_activity') }}
where --is_current = 1 and 
projectobjectid = projectid