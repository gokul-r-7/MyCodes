{{ config(materialized='table') }}


SELECT DISTINCT
    activitydefaultactivitytype,
    activitydefaultcalendarname,
    activitydefaultcalendarobjectid,
    activitydefaultcostaccountobjectid,
    activitydefaultdurationtype,
    activitydefaultpercentcompletetype,
    activitydefaultpriceperunit,
    activitydefaultreviewrequired,
    activityidbasedonselectedactivity,
    activityidincrement,
    activityidprefix,
    activityidsuffix,
    activitypercentcompletebasedonactivitysteps,
    addactualtoremaining,
    addedby,
    allownegativeactualunitsflag,
    allowstatusreview,
    annualdiscountrate,
    anticipatedfinishdate,
    anticipatedstartdate,
    assignmentdefaultdrivingflag,
    assignmentdefaultratetype,
    calculatefloatbasedonfinishdate,
    checkoutdate,
    checkoutstatus,
    checkoutuserobjectid,
    computetotalfloattype,
    containssummarydata,
    contractmanagementgroupname,
    contractmanagementprojectname,
    costquantityrecalculateflag,
    createdate,
    createuser,
    criticalactivityfloatlimit,
    criticalactivityfloatthreshold,
    criticalactivitypathtype,
    criticalfloatthreshold,
    currentbaselineprojectobjectid,
    currentbudget,
    currentvariance,
    datadate,
    dateadded,
    defaultpricetimeunits,
    description,
    discountapplicationperiod,
    distributedcurrentbudget,
    earnedvaluecomputetype,
    earnedvalueetccomputetype,
    earnedvalueetcuservalue,
    earnedvalueuserpercent,
    enableprimesycflag,
    enablepublication,
    enablesummarization,
    etlinterval,
    externalcrkey,
    financialperiodtemplateid,
    finishdate,
    fiscalyearstartmonth,
    forecastfinishdate,
    forecaststartdate,
    guid,
    hasfuturebucketdata,
    historyinterval,
    historylevel,
    id,
    ignoreotherprojectrelationships,
    independentetclaborunits,
    independentetctotalcost,
    integratedtype,
    integratedwbs,
    istemplate,
    lastapplyactualsdate,
    lastfinancialperiodobjectid,
    lastleveldate,
    lastpublishedon,
    lastscheduledate,
    lastsummarizeddate,
    lastupdatedate,
    lastupdateuser,
    latitude,
    levelallresources,
    leveldateflag,
    levelfloatthresholdcount,
    levelouterassign,
    levelouterassignpriority,
    leveloverallocationpercent,
    levelprioritylist,
    levelresourcelist,
    levelwithinfloat,
    levelingpriority,
    limitmultiplefloatpaths,
    linkactualtoactualthisperiod,
    linkpercentcompletewithactual,
    linkplannedandatcompletionflag,
    locationname,
    locationobjectid,
    longitude,
    makeopenendedactivitiescritical,
    maximummultiplefloatpaths,
    multiplefloatpathsenabled,
    multiplefloatpathsendingactivityobjectid,
    multiplefloatpathsusetotalfloat,
    mustfinishbydate,
    name,
    netpresentvalue,
    obsname,
    obsobjectid,
    objectid,
    originalbudget,
    outofsequencescheduletype,
    overallprojectscore,
    ownerresourceobjectid,
    parentepsid,
    parentepsname,
    parentepsobjectid,
    paybackperiod,
    performancepercentcompletebylaborunits,
    plannedstartdate,
    postresponsepessimisticfinish,
    postresponsepessimisticstart,
    preresponsepessimisticfinish,
    preresponsepessimisticstart,
    priceperunit,
    primaryresourcescanmarkactivitiesascompleted,
    primaryresourcescanupdateactivitydates,
    projectforecaststartdate,
    projectscheduletype,
    propertytype,
    proposedbudget,
    publicationpriority,
    publishlevel,
    relationshiplagcalendar,
    resetplannedtoremainingflag,
    resourcecanbeassignedtosameactivitymorethanonce,
    resourcename,
    resourcescanassignthemselvestoactivities,
    resourcescanassignthemselvestoactivitiesoutsideobsaccess,
    resourcescaneditassignmentpercentcomplete,
    resourcescanmarkassignmentascompleted,
    resourcescanstaffroleassignment,
    resourcescanviewinactiveactivities,
    returnoninvestment,
    reviewtype,
    riskexposure,
    risklevel,
    riskmatrixname,
    riskmatrixobjectid,
    riskscore,
    schedulewbshierarchytype,
    scheduledfinishdate,
    sourceprojectobjectid,
    startdate,
    starttostartlagcalculationtype,
    status,
    statusreviewername,
    statusreviewerobjectid,
    strategicpriority,
    summarizeresourcesrolesbywbs,
    summarizetowbslevel,
    summarizeddatadate,
    summaryaccountingvariancebycost,
    summaryaccountingvariancebylaborunits,
    summaryactivitycount,
    summaryactualduration,
    summaryactualexpensecost,
    summaryactualfinishdate,
    summaryactuallaborcost,
    summaryactuallaborunits,
    summaryactualmaterialcost,
    summaryactualnonlaborcost,
    summaryactualnonlaborunits,
    summaryactualstartdate,
    summaryactualthisperiodcost,
    summaryactualthisperiodlaborcost,
    summaryactualthisperiodlaborunits,
    summaryactualthisperiodmaterialcost,
    summaryactualthisperiodnonlaborcost,
    summaryactualthisperiodnonlaborunits,
    summaryactualtotalcost,
    summaryactualvaluebycost,
    summaryactualvaluebylaborunits,
    summaryatcompletionduration,
    summaryatcompletionexpensecost,
    summaryatcompletionlaborcost,
    summaryatcompletionlaborunits,
    summaryatcompletionmaterialcost,
    summaryatcompletionnonlaborcost,
    summaryatcompletionnonlaborunits,
    summaryatcompletiontotalcost,
    summaryatcompletiontotalcostvariance,
    summarybaselinecompletedactivitycount,
    summarybaselineduration,
    summarybaselineexpensecost,
    summarybaselinefinishdate,
    summarybaselineinprogressactivitycount,
    summarybaselinelaborcost,
    summarybaselinelaborunits,
    summarybaselinematerialcost,
    summarybaselinenonlaborcost,
    summarybaselinenonlaborunits,
    summarybaselinenotstartedactivitycount,
    summarybaselinestartdate,
    summarybaselinetotalcost,
    summarybudgetatcompletionbycost,
    summarybudgetatcompletionbylaborunits,
    summarycompletedactivitycount,
    summarycostpercentcomplete,
    summarycostpercentofplanned,
    summarycostperformanceindexbycost,
    summarycostperformanceindexbylaborunits,
    summarycostvariancebycost,
    summarycostvariancebylaborunits,
    summarycostvarianceindex,
    summarycostvarianceindexbycost,
    summarycostvarianceindexbylaborunits,
    summarydurationpercentcomplete,
    summarydurationpercentofplanned,
    summarydurationvariance,
    summaryearnedvaluebycost,
    summaryearnedvaluebylaborunits,
    summaryestimateatcompletionbycost,
    summaryestimateatcompletionbylaborunits,
    summaryestimateatcompletionhighpercentbylaborunits,
    summaryestimateatcompletionlowpercentbylaborunits,
    summaryestimatetocompletebycost,
    summaryestimatetocompletebylaborunits,
    summaryexpensecostpercentcomplete,
    summaryexpensecostvariance,
    summaryfinishdatevariance,
    summaryinprogressactivitycount,
    summarylaborcostpercentcomplete,
    summarylaborcostvariance,
    summarylaborunitspercentcomplete,
    summarylaborunitsvariance,
    summarylevel,
    summarymaterialcostpercentcomplete,
    summarymaterialcostvariance,
    summarynonlaborcostpercentcomplete,
    summarynonlaborcostvariance,
    summarynonlaborunitspercentcomplete,
    summarynonlaborunitsvariance,
    summarynotstartedactivitycount,
    summaryperformancepercentcompletebycost,
    summaryperformancepercentcompletebylaborunits,
    summaryplannedcost,
    summaryplannedduration,
    summaryplannedexpensecost,
    summaryplannedfinishdate,
    summaryplannedlaborcost,
    summaryplannedlaborunits,
    summaryplannedmaterialcost,
    summaryplannednonlaborcost,
    summaryplannednonlaborunits,
    summaryplannedstartdate,
    summaryplannedvaluebycost,
    summaryplannedvaluebylaborunits,
    summaryprogressfinishdate,
    summaryremainingduration,
    summaryremainingexpensecost,
    summaryremainingfinishdate,
    summaryremaininglaborcost,
    summaryremaininglaborunits,
    summaryremainingmaterialcost,
    summaryremainingnonlaborcost,
    summaryremainingnonlaborunits,
    summaryremainingstartdate,
    summaryremainingtotalcost,
    summaryschedulepercentcomplete,
    summaryschedulepercentcompletebylaborunits,
    summaryscheduleperformanceindexbycost,
    summaryscheduleperformanceindexbylaborunits,
    summaryschedulevariancebycost,
    summaryschedulevariancebylaborunits,
    summaryschedulevarianceindex,
    summaryschedulevarianceindexbycost,
    summaryschedulevarianceindexbylaborunits,
    summarystartdatevariance,
    summarytocompleteperformanceindexbycost,
    summarytotalcostvariance,
    summarytotalfloat,
    summaryunitspercentcomplete,
    summaryvarianceatcompletionbylaborunits,
    syncwbshierarchyflag,
    teammemberactivityfields,
    teammemberaddnewactualunits,
    teammemberassignmentoption,
    teammemberassignmentproficiencyflag,
    teammembercanoutofsequenceflag,
    teammembercanstatusotherresources,
    teammembercanupdatenotebooks,
    teammemberdisplaybaselinedatesflag,
    teammemberdisplaydiscussionsflag,
    teammemberdisplayplannedunits,
    teammemberdisplaytotalfloatflag,
    teammemberincludeprimaryresources,
    teammemberprojectviewablefields,
    teammemberreadonlyactivityfields,
    teammemberresourceassignmentfields,
    teammemberstepudfviewablefields,
    teammemberstepsadddeletable,
    teammemberviewablefields,
    totalbenefitplan,
    totalbenefitplantally,
    totalfunding,
    totalspendingplan,
    totalspendingplantally,
    unallocatedbudget,
    undistributedcurrentvariance,
    unifiercbstasksonlyflag,
    unifierdatamappingname,
    unifierdeleteactivitiesflag,
    unifierenabledflag,
    unifierprojectname,
    unifierprojectnumber,
    unifierschedulesheetname,
    unitpertimeovertimefactor,
    useexpectedfinishdates,
    useprojectbaselineforearnedvalue,
    wbscategoryobjectid,
    wbscodeseparator,
    wbshierarchylevels,
    wbsmilestonepercentcomplete,
    wbsobjectid,
    websiterootdirectory,
    websiteurl,
    execution_date
--    is_current   
FROM 
(
    SELECT DISTINCT
        *,
        ROW_NUMBER() OVER (PARTITION BY objectid order by execution_date DESC) as rownum
    FROM 
    {{ source('curated_vg_p6', 'curated_project') }}
    WHERE 
    --is_current = 1 and 
    objectid = projectid
) t
WHERE rownum = 1