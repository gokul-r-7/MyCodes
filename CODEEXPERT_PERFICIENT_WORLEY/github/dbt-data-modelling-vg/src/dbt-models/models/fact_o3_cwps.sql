{{ config(materialized='table') }}

select 
    cast(primary_key as varchar) as cwpspk,
    concat('CWP-', name) as activityid,
    cast(id as int) as entityid,
    cast(entitytypeid as int),
    cast(constructionworkareaid as int),
    cast(disciplineid as int),
    cast(constructiontypeid as int),
    cast(wbsid as int),
    cast(wbs as varchar),
    cast(projectid as int),
    cast(projectinfo as varchar),
    cast(statusid as int),
    cast(status as varchar),
    cast(statusdate as varchar),
    cast(cwpstatus as varchar),
    cast(cwpstatuscolor as varchar),
    cast(name as varchar) as cwpsid,
    cast(description as varchar) as cwpsdescription,
    cast(longdescription as varchar) as cwpslongdescription,
    cast(unitid as int),
    cast(unit as varchar),
    cast(zoneid as int),
    cast(zone as varchar),
    cast(areaid as int),
    cast(area as varchar),
    cast(cwadescription as varchar),
    cast(purposeid as varchar),
    cast(purpose as varchar),
    cast(contractid as int),
    cast(contract as varchar),
    cast(planneruserid as int),
    cast(planneruser as varchar),
    cast(planneruseremail as varchar),
    cast(significantrequirements as varchar),
    cast(scopeexclusions as varchar),
    cast(externallink as varchar),
    cast(revision as varchar),
    cast(revisiondate as varchar),
    cast(scopeid as varchar),
    cast(scope as varchar),
    cast(deliveryteamid as varchar),
    cast(deliveryteam as varchar),
    cast(drawingcount as int),
    cast(budgetedhours as float),
    cast(estimatedhours as float),
    cast(scheduleactivityid as varchar),
    cast(plannedissuedate as timestamp),
    cast(actualissuedate as timestamp),
    cast(issuedatevariance as float),
    cast(plannedstartdate as timestamp),
    cast(plannedstartyear as int),
    cast(plannedstartmonth as varchar),
    cast(plannedstartweekofyear as varchar),
    cast(plannedstartdayofyear as varchar),
    cast(plannedstartweek as varchar),
    cast(actualstartdate as timestamp),
    cast(actualstartyear as varchar),
    cast(actualstartmonth as varchar),
    cast(actualstartweekofyear as varchar),
    cast(actualstartdayofyear as varchar),
    cast(startdatevariance as float),
    cast(plannedfinishdate as timestamp),
    cast(actualfinishdate as timestamp),
    cast(finishdatevariance as float),
    cast(actualfinishyear as varchar),
    cast(actualfinishmonth as varchar),
    cast(actualfinishweekofyear as varchar),
    cast(actualfinishdayofyear as varchar),
    cast(assemblystartdate as timestamp),
    cast(assemblyfinishdate as timestamp),
    cast(releasedtouserid as varchar),
    cast(releasedtouser as varchar),
    cast(plannedreleasedate as timestamp),
    cast(forecastreleasedate as timestamp),
    cast(datedelivered as timestamp),
    cast(earnedhours as float),
    cast(actualhours as float),
    cast(forecastedhours as float),
    cast(percentcomplete as float),
    cast(percentdocumented as float),
    cast(percentdocumentedinclusive as float),
    cast(percentconstraintfree as float),
    cast(percentdelayfree as float),
    cast(percentapproved as float),
    cast(percentdeveloped as float),
    cast(designareacode as varchar),
    cast(designarea as varchar),
    cast(volumetypecode as varchar),
    cast(volumetype as varchar),
    cast(modulenumber as varchar),
    cast(modulehandlingcode as varchar),
    cast(modulehandlingdescription as varchar),
    cast(cwpsequencenumber as varchar),
    cast(materialdestination as varchar),
    cast(datecreated as timestamp),
    cast(createdbyuserid as int),
    cast(createdbyuser as varchar),
    cast(datemodified as timestamp),
    cast(modifiedbyuserid as int),
    cast(modifiedbyuser as varchar),
    cast(isdeleted as boolean),
    cast(plannedduration as int),
    cast(actualduration as varchar),
    cast(openconstraintcount as int),
    cast(iwptotalestimatedhours as float),
    cast(percentageplanned as float),
    cast(sourcedeleted as boolean),
    cast(dateconstraintfree as varchar),
    cast(keyquantity as float),
    cast(unitofmeasureid as varchar),
    cast(uom as varchar),
    cast(releasedquantity as float),
    cast(percentreleased as float),
    cast(technicalauthorshiptransferdate as timestamp),
    cast(datedatacomplete as timestamp),
    cast(datecloseoutdatacomplete as timestamp),
    cast(datacompletenessstatus as varchar),
    cast(estimatedcost as float),
    cast(forecastedcost as float),
    cast(actualcost as float),
    cast(planneddevelopmentstartdate as timestamp),
    cast(actualdevelopmentstartdate as timestamp),
    cast(plannedreadyforreviewdate as timestamp),
    cast(readyforreviewdate as timestamp),
    cast(plannedapproveddate as timestamp),
    cast(approveddate as timestamp),
    cast(draftreviewdate as timestamp),
    cast(plannedcloseoutdate as timestamp),
    cast(actualcloseoutdate as timestamp),
    cast(overviewmodelshotattachmentid as int),
    cast(contractgroupid as varchar),
    cast(contractgroup as varchar),
    cast(criticalpath as boolean),
    cast(criticalpathcategoryid as varchar),
    cast(criticalpathcategory as varchar),
    cast(cwpreleasecount as int),
    cast(overdueconstraintcount as int),
    cast(totalconstraintcount as int),
    cast(closedconstraintcount as int),
    cast(baselinestartdate as timestamp),
    cast(baselinefinishdate as timestamp),
    cast(attachmentcount as int),
    cast(unitcategoryid as varchar),
    cast(unitcategory as varchar),
    cast(labels as varchar),
    cast(stateid as int),
    cast(forecaststartdate as timestamp),
    cast(forecastfinishdate as timestamp),
    cast(externallinkverified as boolean),
    cast(externallinkverifiedbyuser as varchar),
    cast(externallinkverifiedbyuserid as varchar),
    cast(externallinkverifieddate as timestamp),
    cast(dateapprovedforconstruction as timestamp),
    cast(plannedapprovedforconstructiondate as timestamp),
    cast(forgemodelshotstate as varchar),
    cast(invalidmodeldata as boolean),
    cast(calendarstartdate as timestamp),
    cast(calendarenddate as timestamp),
    cast(statuscolor as varchar),
    cast(masterentityid as varchar),
    cast(releasedbyuserid as varchar),
    cast(releasedbyuser as varchar),
    cast(datereleased as timestamp),
    cast(hasreleasedversion as boolean),
    cast(hasworkingversion as boolean),
    cast(leadengineeruserid as int),
    cast(constructionrepresentativeuserid as int),
    cast(leadengineer as varchar),
    cast(leadengineeremail as varchar),
    cast(constructionrepresentative as varchar),
    cast(constructionrepresentativeemail as varchar),
    cast(isworkingversion as boolean),
    cast(lastreleasedversionentityid as varchar),
    cast(budgetedearnedhours as float),
    cast(modelshot as boolean),
    cast(forecastduration as varchar),
    cast(projectphaseid as int),
    cast(projectphase as varchar),
    cast(drawingfilecount as int),
    cast(lessonslearnednotes as varchar),
    cast(safetynotes as varchar),
    cast(interfacenotes as varchar),
    cast(constructabilitynotes as varchar),
    cast(qualitynotes as varchar),
    cast(vendornotes as varchar),
    cast(benchmarknotes as varchar),
    cast(unreleaseddrawingcount as int),
    cast(plotplancount as int),
    cast(drawingsupdatedafterlatestreleasecount as int),
    cast(preferredplotplanid as varchar),
    cast(preferredplotplan as varchar),
    cast(contractors as varchar),
    cast(scheduledatadate as timestamp),
    cast(earlystartdate as timestamp),
    cast(latestartdate as timestamp),
    cast(earlyfinishdate as timestamp),
    cast(latefinishdate as timestamp),
    cast(functionalareaid as varchar),
    cast(functionalarea as varchar),
    cast(componentkeyquantityuom as varchar),
    cast(componentkeyquantityunitofmeasureid as varchar),
    cast(componentkeyquantityunitfield as varchar),
    cast(componentkeyquantityunitfieldid as varchar),
    cast(componentkeyquantity as float),
    cast(is_current as int),
    cast(eff_start_date as timestamp),
    cast(eff_end_date as timestamp)
from 
        {{ source('curated_vg_o3', 'curated_cwps') }}
where is_current = 1

--ALTER TABLE fact_o3_cwps ADD CONSTRAINT cwps_pk PRIMARY KEY (cwpspk);
